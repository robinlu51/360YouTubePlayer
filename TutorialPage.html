<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="TutorialStyle.css">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>
</head>
<body>
<form id="videoControl0">
    <!--
    sPyAQQklc1s
    NLB4Fcxh1iU
    biz9q2L-OvE
    <input type="text" id="textInput" value="G-XZhKqQAHU">
    -->

    <button type="button" id="playButton" class="button" onclick="onPlayClick()">Play</button>
    <!--
    <button type="button" class="button" onclick="pauseVideo()">Pause!</button>
    -->
    <button type="button" id="restartButton" class="button" onclick="restartVideo()">Restart!</button>
    <button type="button" id="muteButton" class="button" onclick="toggleMute()">Mute</button>
    <input type="checkbox" id="visualIndicatorCheckBox" onclick="toggleVisualIndicator()">
    <label for="visualIndicatorCheckBox" id="visualIndicatorLabel">Show Visual Indicator</label>
    <!--
    <button type="button" class="button" onclick="onLoadClick()">Load!</button>
    <button type="button" class="button" onclick="stopVideo()">Stop!</button>
    -->
    <div id="controlOptions0">
        <div class="tab" id="controlMethodTab">
            <input type="checkbox" id="control1_checkbox">
            <button type="button" id="control1button" class="tablinks" onclick="switchTab('control1')"
                    style="background-color: #8ff2a3">Perspective Control with Mouse
            </button>
            <input type="checkbox" id="control2_checkbox">
            <button type="button" id="control2button" class="tablinks" onclick="switchTab('control2')">Adaptive
                Perspective Control with Mouse
            </button>
            <input type="checkbox" id="control3_checkbox">
            <button type="button" id="control3button" class="tablinks" onclick="switchTab('control3')">Direction
                Buttons
            </button>
            <input type="checkbox" id="control4_checkbox">
            <button type="button" id="control4button" class="tablinks" onclick="switchTab('control4')">Drag and Drop
            </button>
        </div>

        <div id="player0"></div>


        <div id="control1" class="tabContent">
            <div id="tutorialSection1" style="margin-top: 10px;margin-bottom: 10px;text-align: center">
                <!--  This is where the HTML element for tutorial 1 steps were, I'm keeping this for documentation purpose, in case I need to refer to this-->
                <!--
                <div id="tutorial1Step1" class="tutorialStep"><input type="checkbox"
                                                                     id="tutorial1Checkbox1"
                                                                     style="outline: 2px solid coral"> To start,
                    first click on the
                    big start button in the middle
                </div>
                <div id="tutorial1CompleteMessage1" class="tutorialStep" style="display: none">Well done! Click this
                    button to go to the
                    next step.
                    <br>
                    <button type="button"
                            onclick="$('#tutorial1Checkbox1').prop('checked', true);$('#tutorial1Step2').css('display', 'inline');$('#tutorial1CompleteMessage1').css('display','none');currentTutorialStep=2">
                        Next
                    </button>
                </div>

                <div id="tutorial1Step2" class="tutorialStep" style="display: none"><input type="checkbox"
                                                                                           id="tutorial1Checkbox2"
                                                                                           style="outline: 2px solid coral">
                    Once
                    the video starts, the camera will automatically accelerate towards the direction of your
                    mouse cursor <p id="tutorial1li2" style="display:inline-block;margin-left: 10px">(Horizontal:
                        0/2500, Vertical: 0/1500)</p>
                </div>
                <div id="tutorial1CompleteMessage2" class="tutorialStep" style="display: none">Well done! Click this
                    button to go to the
                    next step.
                    <br>
                    <button type="button"
                            onclick="$('#tutorial1Checkbox2').prop('checked', true);$('#tutorial1Step3').css('display', 'inline');$('#tutorial1CompleteMessage2').css('display','none');currentTutorialStep=3">
                        Next
                    </button>
                </div>

                <div id="tutorial1Step3" class="tutorialStep" style="display: none"><input type="checkbox"
                                                                                           id="tutorial1Checkbox3"
                                                                                           style="outline: 2px solid coral">
                    To stop camera movement, simply move your mouse cursor back to the center of the video player<p
                            id="tutorial1li3" style="display:inline-block;margin-left: 10px">Stop counter: 0/3</p>
                </div>
                <div id="tutorial1CompleteMessage3" class="tutorialStep" style="display: none">Well done! Click this
                    button to go to the
                    next step.
                    <br>
                    <button type="button"
                            onclick="$('#tutorial1Checkbox3').prop('checked', true);$('#tutorial1Step4').css('display', 'inline');$('#tutorial1CompleteMessage3').css('display','none');currentTutorialStep=4">
                        Next
                    </button>
                </div>

                <div id="tutorial1Step4" class="tutorialStep" style="display: none"><input type="checkbox"
                                                                                           id="tutorial1Checkbox4"
                                                                                           style="outline: 2px solid coral">
                    You can also click on the center of the video player to disable camera movement
                </div>
                <div id="tutorial1CompleteMessage4" class="tutorialStep" style="display: none">Well done! Click this
                    button to go to the
                    next step.
                    <br>
                    <button type="button"
                            onclick="$('#tutorial1Checkbox4').prop('checked', true);$('#tutorial1Step5').css('display', 'inline');$('#tutorial1CompleteMessage4').css('display','none');currentTutorialStep=5">
                        Next
                    </button>
                </div>

                <div id="tutorial1Step5" class="tutorialStep" style="display: none"><input type="checkbox"
                                                                                           id="tutorial1Checkbox5"
                                                                                           style="outline: 2px solid coral">
                    Click on the center of the video player again to enable it again
                </div>
                <div id="tutorial1CompleteMessage5" class="tutorialStep" style="display: none">Well done! Click this
                    button to go to the
                    next step.
                    <br>
                    <button type="button"
                            onclick="$('#tutorial1Checkbox5').prop('checked', true);$('#tutorial1Step6').css('display', 'inline');$('#tutorial1CompleteMessage5').css('display','none')">
                        Next
                    </button>
                </div>

                <div id="tutorial1Step6" class="tutorialStep" style="display: none"><br>Congratulations! You've
                    completed this tutorial. Here is the code: 1234
                </div>
                -->
            </div>
            <!--
            <p id="mouseCoords0" style="clear: none;">Mouse cursor X/Y: 0, 0</p>
            -->
            <div id="cursorBox0" class="cursorBox">
                <div id="cursorSafeZone0" class="safeZone"></div>
            </div>
        </div>

        <div id="control2" class="tabContent">
            <div id="tutorialSection2" style="margin-top: 10px;margin-bottom: 10px">
                <ol>
                    <li>To start, first click on the big start button in the middle <input type="checkbox"
                                                                                           id="tutorial2Checkbox1"></li>
                    <li>Once the video starts, the camera will automatically accelerate towards the direction of your
                        mouse cursor<input type="checkbox"
                                           id="tutorial2Checkbox2">
                    </li>
                    <li>To stop camera movement, simply move your mouse cursor back to the center of the video
                        player<input type="checkbox"
                                     id="tutorial2Checkbox3">
                    </li>
                    <li>You can also click on the center of the video player to disable camera movement, click again to
                        enable it again<input type="checkbox"
                                              id="tutorial2Checkbox4">
                    </li>
                    <li>In this control method, you can click anywhere else on the screen, and that will become the new
                        center of camera movement <input type="checkbox"
                                                         id="tutorial2Checkbox5">
                    </li>
                    <li>Your camera moves faster, as your mouse cursor moves further away from where you last
                        clicked<input type="checkbox"
                                      id="tutorial2Checkbox6">
                    </li>
                </ol>
            </div>
            <!--
            <p id="mouseCoords1" style="clear: none;">Mouse cursor X/Y: 0, 0</p>
            -->
            <div id="cursorBox1" class="cursorBox">
                <div id="cursorSafeZone1" class="safeZone"></div>
            </div>
        </div>

        <div id="control3" class="tabContent">
            <div id="tutorialSection3" style="margin-top: 10px;margin-bottom: 10px">
                <ol>
                    <li>To start, first click on the big start button in the middle <input type="checkbox"
                                                                                           id="tutorial3Checkbox1"></li>
                    <li>Look for the highlighted box with the navigation box inside <input type="checkbox"
                                                                                           id="tutorial3Checkbox2"></li>
                    <li>Click on either of the four direction buttons to move camera in that direction <input
                            type="checkbox"
                            id="tutorial3Checkbox3"></li>
                </ol>
            </div>

            <div id="directionBlockBox0" class="blockBox"></div>
            <div id="directionBlockBox1" class="blockBox"></div>
            <div id="directionBlockBox2" class="blockBox"></div>
            <div id="directionHighlightBox" class="highlightBox">
            </div>
        </div>
        <div id="control4" class="tabContent">
            <div id="tutorialSection4" style="margin-top: 10px;margin-bottom: 10px">
                <ol>
                    <li>To start, first click on the big start button in the middle <input type="checkbox"
                                                                                           id="tutorial4Checkbox1"></li>
                    <li>To navigate your camera, simply drag and drop your camera <input type="checkbox"
                                                                                         id="tutorial4Checkbox2"></li>
                </ol>
            </div>

            <div id="dragAndDropBox0" class="blockBox"></div>
            <!--<div id="dragAndDropBox1" class="blockBox"></div>-->
        </div>
        <div id="timelineBox0" class="blockBox"></div>
        <button type="button" id="bigPlayButton" class="bigButton"
                onclick="onPlayClick();hideBigPlayButton();switchTutorialStepTracker();muteVideo()"><i
                class="fa fa-play"></i></button>
    </div>
</form>

<div class="container-fluid">
    <div class="row">
        <!--bootstrap has been taken out, add col-md-8, 4 if need to be restored
        -->
    </div>
</div>
<script>
    // This code loads the IFrame Player API code asynchronously.
    let tag = document.createElement('script');

    tag.src = "https://www.youtube.com/iframe_api";
    let firstScriptTag = document.getElementsByTagName('script')[0];
    firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);

    let PROPERTIES = ['yaw', 'pitch', 'roll', 'fov'];
    let player;
    showVisualIndicator = false;
    let videoControlPadding = 5; //5px of padding for the entire interface
    $('#videoControl0').css('padding', videoControlPadding + 'px');
    let controlOptionsPadding = 5;
    $('#controlOptions0').css('padding', controlOptionsPadding + 'px');
    $(document).ready(function () {
        //   $('#control1').css('display', 'none');
        //this is done so that on load, only control 1 is displayed
        $('#control2').css('display', 'none');
        $('#control3').css('display', 'none');
        $('#control4').css('display', 'none');
    });

    let netYawChange = 0; //keeps track of how much the horizontal FOV has changed
    let netPitchChange = 0; //keeps track of how much the vertical FOV has changed
    let firstYawAlert = false; //keeps track of whether the first yaw change alert has been sent out
    let firstPitchAlert = false; //keeps track of whether the first pitch change alert has been sent out

    let activeControlMethod = 'control1';

    document.getElementById("control1_checkbox").disabled = true;
    document.getElementById("control2_checkbox").disabled = true;
    document.getElementById("control3_checkbox").disabled = true;
    document.getElementById("control4_checkbox").disabled = true;

    let currentTutorialMethodNum = 0; //keeps track of which control method is active in the tutorial, 1 indicates control method 1, 2 indicates control method 2, etc.
    let currentTutorialStep = 0; //keeps track of which tutorial step the user is currently on, for now, 1 indicates step 1, 2 indicates step 2, etc.
    /*document.getElementById("tutorial1Checkbox1").disabled = true;
    document.getElementById("tutorial1Checkbox2").disabled = true;
    document.getElementById("tutorial1Checkbox3").disabled = true;
    document.getElementById("tutorial1Checkbox4").disabled = true;
    document.getElementById("tutorial1Checkbox5").disabled = true;

    document.getElementById("tutorial2Checkbox1").disabled = true;
    document.getElementById("tutorial2Checkbox2").disabled = true;
    document.getElementById("tutorial2Checkbox3").disabled = true;
    document.getElementById("tutorial2Checkbox4").disabled = true;
    document.getElementById("tutorial2Checkbox5").disabled = true;
    document.getElementById("tutorial2Checkbox6").disabled = true;

    document.getElementById("tutorial3Checkbox1").disabled = true;
    document.getElementById("tutorial3Checkbox2").disabled = true;
    document.getElementById("tutorial3Checkbox3").disabled = true;

    document.getElementById("tutorial4Checkbox1").disabled = true;
    document.getElementById("tutorial4Checkbox2").disabled = true;*/

    let tutorialMessage = [ // component used to assemble the messages that will be shown to the user
        {
            type: 0, //type 0 for instruction message, type 1 for message that will be displayed on completion
            //if we add more types, remember to update logic in renderHTML()
            sectionID: 1, //indicate which tutorial this is for, with Perspective Control w/ Mouse being 1, Drag & Drop being 4, etc.
            stepNum: 1, // step number that this message belongs to, start at 1 corresponding to the step number. Completion messages have the same step number as the step it belongs to
            message: "To start, first click on the big start button in the middle", // Leave a space at the beginning of instructions because of the existence of checkboxes
            verifyFunc: function () { // verifyFunc is used to set up event listeners and other functions that will be used to check tutorial progress within each step
                //let eventLF = function () { //this currently doesn't do anything since nothing calls verifyFunc() for this element yet
                console.log('Alert 0'); // this alert is currently only for debugging purposes, remove when finished implementing
                //}
                //document.getElementById("bigPlayButton").addEventListener('click', eventLF);
            }
        },
        {
            type: 1,
            sectionID: 1,
            stepNum: 1,
            message: "Well done! Click this button to go to the next step.1",
            verifyFunc: function () {
                console.log('Alert 1');
            }
        },
        {
            type: 0,
            sectionID: 1,
            stepNum: 2,
            message: "Once the video starts, the camera will automatically accelerate towards the direction of your mouse cursor <p id=\"tutorial1li2\" style=\"display:inline-block;margin-left: 10px\">(Horizontal: <span id='horizontalCameraTrack1'>0</span>/800, Vertical: <span id='verticalCameraTrack1'>0</span>/150)</p>",
            verifyFunc: function () {
                let previousYaw = player.getSphericalProperties()['yaw'];
                let previousPitch = player.getSphericalProperties()['pitch'];
                let eventLF = function (event) {
                    let newYaw = player.getSphericalProperties()['yaw'];
                    let newPitch = player.getSphericalProperties()['pitch'];
                    let netYawChangeThreshold = 800;
                    let netPitchChangeThreshold = 150;

                    //TODO This calculation is currently bugged, since Yaw only goes from [0, 360), Pitch only goes from [-90, 90], there's a problem with overflow
                    netYawChange += Math.abs(previousYaw - newYaw);
                    netPitchChange += Math.abs(previousPitch - newPitch);
                    previousYaw = newYaw;
                    previousPitch = newPitch;
                    if (netYawChange < netYawChangeThreshold) {
                        document.querySelector('#horizontalCameraTrack1').innerHTML = `${Math.round(netYawChange)}`;
                    } else {
                        document.querySelector('#horizontalCameraTrack1').innerHTML = `${netYawChangeThreshold}`;
                    }
                    if (netPitchChange < netPitchChangeThreshold) {
                        document.querySelector('#verticalCameraTrack1').innerHTML = `${Math.round(netPitchChange)}`;
                    } else {
                        document.querySelector('#verticalCameraTrack1').innerHTML = `${netPitchChangeThreshold}`;
                    }
                    /*
                    if (netYawChange < netYawChangeThreshold && netPitchChange < netPitchChangeThreshold) {
                        document.querySelector('#tutorial1li2').innerHTML = `(Horizontal: ${netYawChange}/2500, Vertical: ${netPitchChange}/150)`;
                    } else if (netYawChange >= netYawChangeThreshold && netPitchChange < netPitchChangeThreshold) {
                        document.querySelector('#tutorial1li2').innerHTML = `(Horizontal: 2500/2500, Vertical: ${netPitchChange}/150)`;
                    } else if (netYawChange < netYawChangeThreshold && netPitchChange >= netPitchChangeThreshold) {
                        document.querySelector('#tutorial1li2').innerHTML = `(Horizontal: ${netYawChange}/2500, Vertical: 150/150)`;
                    } else {
                        document.querySelector('#tutorial1li2').innerHTML = `(Horizontal: 2500/2500, Vertical: 150/150)`;
                    }*/

                    if ((firstYawAlert && firstPitchAlert) && ((currentTutorialMethodNum == 1) && (currentTutorialStep == 2))) {
                        //$('#tutorial1Checkbox2').prop('checked', true);
                        nextStep(currentTutorialMethodNum, currentTutorialStep);
                        //$('#tutorial1Step3').css('display', 'inline');
                    }

                    if (netYawChange > netYawChangeThreshold && firstYawAlert == false) {
                        firstYawAlert = true;
                        console.log('Yaw moved 2500');
                    }
                    if (netPitchChange > netPitchChangeThreshold && firstPitchAlert == false) {
                        firstPitchAlert = true;
                        console.log('Pitch moved 150');
                    }
                    //TODO remember to remove event listener
                }
                document.getElementById("cursorBox0").addEventListener('mousemove', eventLF);
            }
        },
        {
            type: 1,
            sectionID: 1,
            stepNum: 2,
            message: "Well done! Click this button to go to the next step.3",
            verifyFunc: function () {
                console.log('Alert 3');
            }
        },
        {
            type: 0,
            sectionID: 1,
            stepNum: 3,
            message: "To stop camera movement, simply move your mouse cursor back to the center of the video player<p id=\"tutorial1li3\" style=\"display:inline-block;margin-left: 10px\">Stop counter: 0/3</p>",
            verifyFunc: function () {
                //
                let control1StopCounter = 0;
                let eventLF = function () {
                    mouseInsideSafeZone0 = true;
                    if (control1StopCounter < 3 && ((currentTutorialMethodNum == 1) && (currentTutorialStep == 3))) { //only start tracking step 3 after step 2 has been completed
                        control1StopCounter++;
                    }
                    document.querySelector('#tutorial1li3').innerHTML = `Stop counter: ${control1StopCounter}/3`;
                    if ((control1StopCounter >= 3) && ((currentTutorialMethodNum == 1) && (currentTutorialStep == 3))) {
                        //$('#tutorial1Checkbox3').prop('checked', true);
                        nextStep(currentTutorialMethodNum, currentTutorialStep);
                        //$('#tutorial1Step4').css('display', 'inline');
                        // get rid of event handler because it is not necessary anymore
                        document.getElementById("cursorSafeZone0").removeEventListener('mouseenter', eventLF);
                    }
                }
                document.getElementById("cursorSafeZone0").addEventListener('mouseenter', eventLF);
            }
        },
        {
            type: 1,
            sectionID: 1,
            stepNum: 3,
            message: "Well done! Click this button to go to the next step.5",
            verifyFunc: function () {
                console.log('Alert 5');
            }
        },
        {
            type: 0,
            sectionID: 1,
            stepNum: 4,
            message: "You can also click on the center of the video player to disable camera movement",
            verifyFunc: function () {
                console.log('Alert 6');
                let eventLF = function () {
                    nextStep(currentTutorialMethodNum, currentTutorialStep);
                    //TODO remember to remove event listener
                }
                document.getElementById("cursorSafeZone0").addEventListener('click', eventLF)
            }
        },
        {
            type: 1,
            sectionID: 1,
            stepNum: 4,
            message: "Well done! Click this button to go to the next step.",
            verifyFunc: function () {
                console.log('Alert 7');
            }
        },
        {
            type: 0,
            sectionID: 1,
            stepNum: 5,
            message: "Click on the center of the video player again to enable it again",
            verifyFunc: function () {
                let eventLF = function(){
                    nextStep(currentTutorialMethodNum, currentTutorialStep);
                    //TODO remember to remove event listener
                }
                document.getElementById("cursorSafeZone0").addEventListener('click', eventLF);
            }
        },
        {
            type: 1,
            sectionID: 1,
            stepNum: 5,
            message: "Well done! Click this button to go to the next step.",
            verifyFunc: function () {
                console.log('Alert 9');
            }
        },
        {
            type: 0,
            sectionID: 1,
            stepNum: 6,
            message: "Congratulations! You've completed this tutorial. Here is the code: 1234",
            verifyFunc: function () {
                console.log('Alert 10');
            }
        }
    ];

    let renderHTML = function (message) { //this renders the html elements, assembling them together
        let renderedHTML;
        if (message.type == 0) { // if it's an instruction message, render it this way
            if (message.stepNum == 1) { // if it's the first tutorial message of its section, display it to start
                renderedHTML = '<div id="tutorial' + message.sectionID + 'Step' + message.stepNum + '" class="tutorialStep">' + message.message + '</div>';
            } else { // if it isn't the first tutorial message of its section, set display to none to start
                renderedHTML = '<div id="tutorial' + message.sectionID + 'Step' + message.stepNum + '" class="tutorialStep" style="display: none">' + message.message + '</div>';
            }
        } else { // if it's a completion message, render it this way
            //for now, we can use else, considering we only have type 0 and type 1, if we add more types in the future, will need to update this
            renderedHTML = '<div id="tutorial' + message.sectionID + 'CompleteMessage' + message.stepNum + '" class="tutorialStep" style="display: none">' + message.message + '<br><button type="button" onclick="$(\'#tutorial' + message.sectionID + 'Step' + (message.stepNum + 1) + '\').css(\'display\', \'inline\');$(\'#tutorial' + message.sectionID + 'CompleteMessage' + message.stepNum + '\').css(\'display\',\'none\');currentTutorialStep=' + (message.stepNum + 1) + ';tutorialMessage[' + (message.stepNum * 2) + '].verifyFunc()' + '">Next</button></div>'
            //here, we set currentTutorialStep to current step number + 1 because we're moving onto the next step
        }
        return renderedHTML;
    }

    let renderMessage = function () { //called when page is ready, renders all messages in current control method section, although only the first is shown at the start
        for (let i = 0; i < tutorialMessage.length; i++) {
            $('#tutorialSection1').append(renderHTML(tutorialMessage[i]));
        }
        //$('#tutorialSection1').append(renderHTML(tutorialMessage[2]));
    }

    $(document).ready(function () {
        renderMessage();
    })


    let myURL = new URL(window.location.href); //collection for all URL parameters


    let hideControl = myURL.searchParams.get("hideControl"); //URL parameter for whether timeline control is hidden
    let defaultHideControl = '0';
    if (!hideControl > '') { // if there's no control number, default to control 1
        hideControl = defaultHideControl;
    }

    let controlMethod = myURL.searchParams.get("controlMethod"); //URL parameter for the control method on load
    let defaultControlMethod = '0';
    if (!controlMethod > '') { // if there's no input for this, default to 0, which shows all control methods
        controlMethod = defaultControlMethod;
    }

    let hideControlOption = myURL.searchParams.get("hideControlOption"); //URL parameter for whether the control options are hidden
    let defaultHideControlOption = '0';
    if (!hideControlOption > '') { // if there's no input for this, default to 0, which shows all control options
        hideControlOption = defaultHideControlOption;
    }

    let showTutorial = myURL.searchParams.get("showTutorial"); //URL parameter for whether the tutorial is shown
    let defaultShowTutorial = '0';
    if (!showTutorial > '') { // if there's no input for this, default to 0, which shows all control options
        showTutorial = defaultShowTutorial;
    }

    let movableSafeZoneCenterX = 0; //with respect to the cursor box, at 0, 0 if at top left
    let movableSafeZoneCenterY = 0; // THIS WORKS BECAUSE OF CURRENT IMPLEMENTATION, since you have to click on safe zone first to start moving
    // therefore you will always call moveSafeZone, which updates the center of the safe zone for movement detection purpose
    // if implementation changes, this will cause camera to behave like the center is at top left corner, until you move safe zone once

    let cursorBox0Active = true; //indicates if the cursor box is active
    $('#cursorSafeZone0').click(function () {
        if (showVisualIndicator) {
            if (cursorBox0Active) {
                $('#cursorSafeZone0').css('background-color', 'yellow');
            } else {
                $('#cursorSafeZone0').css('background-color', 'greenyellow');
            }
        }
        cursorBox0Active = !cursorBox0Active;
        /*
        if ((currentTutorialMethodNum == 1) && (currentTutorialStep == 4)) {
            //$('#tutorial1Checkbox4').prop("checked", true);
            nextStep(currentTutorialMethodNum, currentTutorialStep);
            //$('#tutorial1Step5').css('display', 'inline');
        }
        //if ($('#tutorial1Checkbox4').prop("checked")) {
        if ((currentTutorialMethodNum == 1) && (currentTutorialStep == 5)) {
            //$('#tutorial1Checkbox5').prop("checked", true);
            nextStep(currentTutorialMethodNum, currentTutorialStep);
            //$('#tutorial1Step6').css('display', 'inline');
        }
        */
    });

    let cursorBox1Active = true; //indicates if the cursor box is active
    $('#cursorSafeZone1').click(function () {
        if (showVisualIndicator) {
            if (cursorBox1Active) {
                $('#cursorSafeZone1').css('background-color', 'yellow');
            } else {
                $('#cursorSafeZone1').css('background-color', 'greenyellow');
            }
        }
        cursorBox1Active = !cursorBox1Active;
    });


    let mass = 95; //for user study version, we might want to give mass a defined value instead of being adjustable.
    mass /= 100; // needed so we don't need to call getElementById twice, and keep the mass value on 0-1 scale

    let prevXVelocity = 0; //by default, the velocity starts at 0
    let prevYVelocity = 0;

    //adding event listeners for Cursor Box (control 1)
    let mouseInsideBox0 = false;
    let mouseInsideSafeZone0 = false;
    document.getElementById("cursorBox0").addEventListener('mouseenter', function () {
        mouseInsideBox0 = true;
    });
    document.getElementById("cursorBox0").addEventListener('mouseleave', function () {
        mouseInsideBox0 = false;
    });

    document.getElementById("cursorSafeZone0").addEventListener('mouseleave', function () {
        mouseInsideSafeZone0 = false;
    });

    //adding event listeners for Cursor Box Alt (control 2)
    let mouseInsideBox1 = false;
    let mouseInsideSafeZone1 = false;
    document.getElementById("cursorBox1").addEventListener('mouseenter', function () {
        mouseInsideBox1 = true;
    });
    document.getElementById("cursorBox1").addEventListener('mouseleave', function () {
        mouseInsideBox1 = false;
    });
    document.getElementById("cursorSafeZone1").addEventListener('mouseenter', function () {
        mouseInsideSafeZone1 = true;
    });
    document.getElementById("cursorSafeZone1").addEventListener('mouseleave', function () {
        mouseInsideSafeZone1 = false;
    });


    let mouseX = 0; // the mouse X coordinate WITH RESPECT TO THE VISIBLE SCREEN
    let mouseY = 0; // the code should show it with respect to
    document.getElementById("cursorBox0").addEventListener('mouseenter', updateCoords);//TODO do I need both mouseenter and mousemove?
    document.getElementById("cursorBox0").addEventListener('mousemove', updateCoords);
    document.getElementById("cursorBox0").addEventListener('mouseenter', cursorCameraControl0);

    document.getElementById("cursorBox1").addEventListener('mouseenter', updateCoords);
    document.getElementById("cursorBox1").addEventListener('mousemove', updateCoords);
    document.getElementById("cursorBox1").addEventListener('mouseenter', cursorCameraControl1);
    document.getElementById("cursorBox1").addEventListener('click', moveSafeZone);
    //this line below should add an event listener, to update the playing status, in case that the user pause/unpauses in
    //Drag&Drop method and the Play/Pause button isn't updated
    //document.getElementById('cursorBox1').addEventListener('click', checkPauseStatus);


    function updateMass(value) { //update the mass value AND text displayed
        mass = value / 100;
    }

    let firstUpdateCoordsCalled = false; //keep track of whether the function updateCoords(event) has been called

    function updateCoords(event) { //update the mouse's coordinates in the global variable
        let tempMouseX = event.clientX;
        let tempMouseY = event.clientY;
        /*let netYawChangeThreshold = 2500;
        let netPitchChangeThreshold = 1500;*/


        /*if (!firstUpdateCoordsCalled) {
            mouseX = tempMouseX;
            mouseY = tempMouseY;
        }*/

        /*
        if (currentTutorialMethodNum == 1 && currentTutorialStep == 2) { //step 2 only starts tracking after step 1 is completed
            netYawChange += Math.abs(tempMouseX - mouseX);//@todo this currently tracks how much the mouse has moved, not how much the camera has moved, which isn't what we want
            netPitchChange += Math.abs(tempMouseY - mouseY);
        }*/
        mouseX = tempMouseX;
        mouseY = tempMouseY;

        /*
        if (netYawChange < netYawChangeThreshold && netPitchChange < netPitchChangeThreshold) {
            document.querySelector('#tutorial1li2').innerHTML = `(Horizontal: ${netYawChange}/2500, Vertical: ${netPitchChange}/1500)`;
        } else if (netYawChange >= netYawChangeThreshold && netPitchChange < netPitchChangeThreshold) {
            document.querySelector('#tutorial1li2').innerHTML = `(Horizontal: 2500/2500, Vertical: ${netPitchChange}/1500)`;
        } else if (netYawChange < netYawChangeThreshold && netPitchChange >= netPitchChangeThreshold) {
            document.querySelector('#tutorial1li2').innerHTML = `(Horizontal: ${netYawChange}/2500, Vertical: 1500/1500)`;
        } else {
            document.querySelector('#tutorial1li2').innerHTML = `(Horizontal: 2500/2500, Vertical: 1500/1500)`;
        }

        if ((firstYawAlert && firstPitchAlert) && ((currentTutorialMethodNum == 1) && (currentTutorialStep == 2))) {
            //$('#tutorial1Checkbox2').prop('checked', true);
            nextStep(currentTutorialMethodNum, currentTutorialStep);
            //$('#tutorial1Step3').css('display', 'inline');
        }

        if (netYawChange > netYawChangeThreshold && firstYawAlert == false) {
            firstYawAlert = true;
            console.log('Yaw moved 2500');
        }
        if (netPitchChange > netPitchChangeThreshold && firstPitchAlert == false) {
            firstPitchAlert = true;
            console.log('Pitch moved 1500');
        }
        firstUpdateCoordsCalled = true;*/
    }

    function moveSafeZone(event) { // moves the safe zone based on mouse click location, center on click location
        $('#cursorSafeZone1').css('margin-left', mouseX - playerLeftGapPublicHolder - safeZone0Radius + 'px');
        $('#cursorSafeZone1').css('margin-top', mouseY - control1HeightPublicHolder - safeZone0Radius + 'px');
        movableSafeZoneCenterX = mouseX - playerLeftGapPublicHolder;
        movableSafeZoneCenterY = mouseY - control1HeightPublicHolder;
    }

    let xModifier = 1; // 1 is the default value, -1 if axis is inverted
    let yModifier = 1;

    function invertX() { //used to invert x-axis control
        xModifier = -xModifier;
    }

    function invertY() { //used to invert y-axis control
        yModifier = -yModifier;
    }

    function cursorCameraControl0() { //camera control for Cursor Box control method
        //get the mouse cursor's current coordinates, with top left of cursor box to be 0,0
        let x = Math.round(mouseX - playerLeftGapPublicHolder);
        let y = Math.round(mouseY - control1HeightPublicHolder);
        //mouseCoordsText0.innerText = `Mouse cursor X/Y: ${x}, ${y}, center at ${windowWidthPublicHolder / 2}, ${windowHeightPublicHolder / 2}`;

        let cameraMultiplierX = 0.003; //necessary to control the overall camera speed
        let cameraMultiplierY = 0.002;
        let newSettings = player.getSphericalProperties();
        let targetedXVelocity = 0; //the velocity we want to achieve
        let targetedYVelocity = 0;
        if (!mouseInsideSafeZone0 && cursorBox0Active) {
            targetedXVelocity = windowWidthPublicHolder / 2 - x; // find the center for cursor box, windowWidth/2 is the num of pixels from edge to center
            targetedYVelocity = windowHeightPublicHolder / 2 - y;
        }
        let combinedXVelocity = ((1 - mass) * targetedXVelocity + mass * prevXVelocity); // the actual velocity calculated with momentum
        let combinedYVelocity = ((1 - mass) * targetedYVelocity + mass * prevYVelocity);
        newSettings['yaw'] += xModifier * cameraMultiplierX * combinedXVelocity;
        newSettings['pitch'] += yModifier * cameraMultiplierY * combinedYVelocity;
        player.setSphericalProperties(newSettings);
        prevXVelocity = combinedXVelocity; //update the previous velocity with the newly calculated value
        prevYVelocity = combinedYVelocity;
        if (mouseInsideBox0) {
            setTimeout(cursorCameraControl0, 16); //timeout at 16ms to ensure around 60 updates/second, since there are roughly 60 * 16 ms in a second
        }
    }

    function cursorCameraControl1() { //camera control for Cursor Box Alt control method
        //get the mouse cursor's current coordinates, with top left of cursor box to be 0,0
        let x = Math.round(mouseX - playerLeftGapPublicHolder);
        let y = Math.round(mouseY - control1HeightPublicHolder);
        // mouseCoordsText1.innerText = `Mouse cursor X/Y: ${x - mouseX}, ${y - mouseY}, center at ${windowWidthPublicHolder / 2}, ${windowHeightPublicHolder / 2}`;

        let cameraMultiplierX = 0.003; //necessary to control the overall camera speed
        let cameraMultiplierY = 0.002;
        let newSettings = player.getSphericalProperties();
        let targetedXVelocity = 0; //the velocity we want to achieve
        let targetedYVelocity = 0;
        if (!mouseInsideSafeZone1 && cursorBox1Active) {
            targetedXVelocity = movableSafeZoneCenterX - x; // find the center for cursor box, windowWidth/2 is the num of pixels from edge to center
            targetedYVelocity = movableSafeZoneCenterY - y;
        }
        let combinedXVelocity = ((1 - mass) * targetedXVelocity + mass * prevXVelocity); // the actual velocity calculated with momentum
        let combinedYVelocity = ((1 - mass) * targetedYVelocity + mass * prevYVelocity);
        newSettings['yaw'] += xModifier * cameraMultiplierX * combinedXVelocity;
        newSettings['pitch'] += yModifier * cameraMultiplierY * combinedYVelocity;
        player.setSphericalProperties(newSettings);
        prevXVelocity = combinedXVelocity; //update the previous velocity with the newly calculated value
        prevYVelocity = combinedYVelocity;
        if (mouseInsideBox1) {
            setTimeout(cursorCameraControl1, 16); //timeout at 16ms to ensure around 60 updates/second, since there are roughly 60 * 16 ms in a second
        }
    }

    let timelineBarHeight = 50;//the height is 50 px
    let control1HeightPublicHolder;
    let playerLeftGapPublicHolder;
    let windowWidthPublicHolder;
    let windowHeightPublicHolder;
    let safeZone0Radius = $('#cursorSafeZone0').height() / 2; //the Cursor Box control method's safe zone area's radius

    function onYouTubeIframeAPIReady() { //<=== does as it says
        let videoRatioWidth = 16; //video player ratio is 16:9 for now
        let videoRatioHeight = 9;
        let videoId0 = myURL.searchParams.get("vidID");
        let defaultVideoID = 'G-XZhKqQAHU'; //for now, default to the Alien 'HELP' video
        if (!videoId0 > '') { // if there's no URL parameter, default to designated video
            videoId0 = defaultVideoID;
        }

        //let adjustedWidth = window.innerWidth * 2 / 3 - 20; //ratio for the col-8 and 4 bootstrap grid
        let control1Height = $('#playButton').height() + $('#controlMethodTab').height() + $('#tutorialSection1').height() + 80; //+ $('#mouseCoords').height()
        let windowHeight = window.innerHeight - 20 - control1Height; //these numbers indicate the maximum size the video player can be
        let windowWidth = window.innerWidth; //maximum width on screen that can be used for display
        //we want to make the video player as large as allowed without needing to scroll, while maintaining a 16:9 ratio
        if (windowHeight >= videoRatioHeight / videoRatioWidth * windowWidth) {
            windowHeight = videoRatioHeight / videoRatioWidth * windowWidth;
        } else if (windowWidth >= videoRatioWidth / videoRatioHeight * windowHeight) {
            windowWidth = videoRatioWidth / videoRatioHeight * windowHeight;
        }
        let playerLeftGap = (window.innerWidth - windowWidth) / 2; //the distance of the gap between player and left/right end, so we can center video player
        let player0 = $('#player0');
        player0.css('position', 'absolute');
        player0.css('top', control1Height + 'px');
        player0.css('left', playerLeftGap + 'px');
        $('#tutorialSection1').css('margin-left', playerLeftGap + 'px');
        $('#tutorialSection1').css('margin-right', playerLeftGap + 'px');
        let bigPlayButtonHeight = 250;
        let bigPlayButtonWidth = 250;
        $('#bigPlayButton').css('font-size', bigPlayButtonHeight / 2 + 'px');
        $('#bigPlayButton').css('height', bigPlayButtonHeight + 'px');
        $('#bigPlayButton').css('width', bigPlayButtonWidth + 'px');
        $('#bigPlayButton').css('top', control1Height + (windowHeight - bigPlayButtonHeight) / 2 + 'px');
        $('#bigPlayButton').css('left', playerLeftGap + (windowWidth - bigPlayButtonWidth) / 2 + 'px');

        control1HeightPublicHolder = control1Height;
        playerLeftGapPublicHolder = playerLeftGap;
        let cursorBox0 = $('#cursorBox0');
        cursorBox0.css('pointer-events', 'none');
        cursorBox0.css('top', control1Height + 'px');
        cursorBox0.css('width', windowWidth + 'px');
        cursorBox0.css('height', windowHeight - timelineBarHeight + 'px');
        cursorBox0.css('margin-left', playerLeftGap + 'px');
        windowWidthPublicHolder = windowWidth;
        windowHeightPublicHolder = windowHeight;
        $('#cursorSafeZone0').css('margin-top', windowHeight / 2 - safeZone0Radius + 'px');
        $('#cursorSafeZone0').css('margin-left', windowWidth / 2 - safeZone0Radius + 'px');
        $('#cursorSafeZone0').css('pointer-events', 'none');

        movableSafeZoneCenterX = windowWidth / 2;
        movableSafeZoneCenterY = windowHeight / 2;
        let safeZone1Radius = $('#cursorSafeZone1').height() / 2; //the Cursor Box Alt control method's safe zone area's radius
        let cursorBox1 = $('#cursorBox1');
        cursorBox1.css('pointer-events', 'none');
        cursorBox1.css('top', control1Height + 'px');
        cursorBox1.css('width', windowWidth + 'px');
        cursorBox1.css('height', windowHeight - timelineBarHeight + 'px');
        cursorBox1.css('margin-left', playerLeftGap + 'px');
        $('#cursorSafeZone1').css('margin-top', windowHeight / 2 - safeZone0Radius + 'px');
        $('#cursorSafeZone1').css('margin-left', windowWidth / 2 - safeZone0Radius + 'px');
        $('#cursorSafeZone1').css('pointer-events', 'none');


        let directionButtonWidth = 65; //the size for the YouTube native navigation button, used in Direction Buttons
        let directionButtonHeight = 60;
        let directionButtonTopGap = 57;
        let directionHighlightBox0 = $('#directionHighlightBox'); //the border box that highlights the direction wheel
        directionHighlightBox0.css('left', playerLeftGap + 'px');
        directionHighlightBox0.css('top', control1Height + directionButtonTopGap + 'px');
        directionHighlightBox0.css('width', directionButtonWidth + 'px');
        directionHighlightBox0.css('height', directionButtonHeight + 'px');
        let directionBlockBox0 = $('#directionBlockBox0'); //the block box above the horizontal level of direction wheel
        directionBlockBox0.css('left', playerLeftGap + 'px');
        directionBlockBox0.css('top', control1Height + 'px');
        directionBlockBox0.css('width', windowWidth + 'px');
        directionBlockBox0.css('height', directionButtonTopGap + 'px');
        let directionBlockBox1 = $('#directionBlockBox1'); //the block box on the same horizontal level of direction wheel
        directionBlockBox1.css('left', playerLeftGap + directionButtonWidth + 'px');
        directionBlockBox1.css('top', control1Height + directionButtonTopGap + 'px');
        directionBlockBox1.css('width', windowWidth - directionButtonWidth + 'px');
        directionBlockBox1.css('height', directionButtonHeight + 'px');
        let directionBlockBox2 = $('#directionBlockBox2');
        directionBlockBox2.css('left', playerLeftGap + 'px');//the block box below the horizontal level of direction wheel
        directionBlockBox2.css('top', control1Height + directionButtonHeight + directionButtonTopGap + 'px');
        directionBlockBox2.css('width', windowWidth + 'px');
        directionBlockBox2.css('height', windowHeight - directionButtonHeight - directionButtonTopGap - timelineBarHeight + 'px');

        let dragAndDropBox0 = $('#dragAndDropBox0'); //block out the direction wheel for Drag & Drop
        dragAndDropBox0.css('left', playerLeftGap + 'px');
        dragAndDropBox0.css('top', control1Height + directionButtonTopGap + 'px');
        dragAndDropBox0.css('width', directionButtonWidth + 'px');
        dragAndDropBox0.css('height', directionButtonTopGap + 'px');
        /*
        let dragAndDropBox1 = $('#dragAndDropBox1'); //block out the timeline for Drag & Drop
        dragAndDropBox1.css('left', playerLeftGap + 'px');
        dragAndDropBox1.css('top', control1Height + windowHeight - 50 + 'px');
        dragAndDropBox1.css('width', windowWidth + 'px');
        dragAndDropBox1.css('height', 50 + 'px');
        dragAndDropBox1.css('opacity', 15 + '%');
        */

        let timelineBox0 = $('#timelineBox0'); //this blocks out the timeline if the hideControl URL parameter is 1
        timelineBox0.css('left', playerLeftGap + 'px');
        timelineBox0.css('top', control1Height + windowHeight - timelineBarHeight + 'px');
        timelineBox0.css('width', windowWidth + 'px');
        timelineBox0.css('height', timelineBarHeight + 1 + 'px'); //needed to add 1 px because of a stray pixel
        timelineBox0.css('display', 'none');
        timelineBox0.css('opacity', 100 + '%');
        if (hideControl == 1) {
            timelineBox0.css('display', 'block');
            timelineBox0.css('background-color', 'white');
        }

        //this hides almost all control options if the hideControlOption URL parameter is 1
        if (hideControlOption == 1) {
            $('#playButton').css('display', 'none');
            $('#restartButton').css('display', 'none');
            $('#muteButton').css('display', 'none');
            $('#visualIndicatorCheckBox').css('display', 'none');
            $('#visualIndicatorLabel').css('display', 'none');
            $('#x_axis').css('display', 'none');
            $('#x_axis_label').css('display', 'none');
            $('#y_axis').css('display', 'none');
            $('#y_axis_label').css('display', 'none');
            $('#massValue').css('display', 'none');
            $('#sliderBar').css('display', 'none');
        }

        if (player == null) { // if there's no pre-existing video player, we create it here
            player = new YT.Player('player0', {
                //height: 700,
                //width: adjustedWidth,
                height: windowHeight,
                width: windowWidth,
                videoId: videoId0,
                playerVars: {
                    rel: 0, // on pause screen, only display videos from same channel, since we can't disable this following YouTube update
                    disablekb: 1 //disable keyboard control
                },
                events: {
                    'onReady': onPlayerReady,
                    'onStateChange': onStateChange
                }
            });
        }
        if (controlMethod != 0) {
            exclusiveTab('control' + controlMethod);
        }
    }

    function toggleVisualIndicator() { //toggle colored visual indicator for clickable/unclickable zones
        let visualIndicatorLabel = $('#visualIndicatorLabel');
        if (showVisualIndicator) {
            $('#cursorBox0').css('background-color', 'transparent');
            $('#cursorSafeZone0').css('background-color', 'transparent');
            $('#cursorBox1').css('background-color', 'transparent');
            $('#cursorSafeZone1').css('background-color', 'transparent');
            $('#directionBlockBox0').css('background-color', 'transparent');
            $('#directionBlockBox1').css('background-color', 'transparent');
            $('#directionBlockBox2').css('background-color', 'transparent');
            $('#dragAndDropBox0').css('background-color', 'transparent');
            $('#dragAndDropBox1').css('background-color', 'transparent');
            visualIndicatorLabel.html('Visual Indicator Shown');
        } else {
            $('#cursorBox0').css('background-color', 'lightblue');
            if (cursorBox0Active) {
                $('#cursorSafeZone0').css('background-color', 'greenyellow');
            } else {
                $('#cursorSafeZone0').css('background-color', 'yellow');
            }
            $('#cursorBox1').css('background-color', 'lightblue');
            if (cursorBox1Active) {
                $('#cursorSafeZone1').css('background-color', 'greenyellow');
            } else {
                $('#cursorSafeZone1').css('background-color', 'yellow');
            }
            $('#directionBlockBox0').css('background-color', 'lightblue');
            $('#directionBlockBox1').css('background-color', 'lightblue');
            $('#directionBlockBox2').css('background-color', 'lightblue');
            $('#dragAndDropBox0').css('background-color', 'lightblue');
            $('#dragAndDropBox1').css('background-color', 'lightblue');
            visualIndicatorLabel.html('Visual Indicator Hidden');
        }
        showVisualIndicator = !showVisualIndicator;
    }

    // The API will call this function when the video player is ready.
    function onPlayerReady(event) { //currently unused
        //event.target.playVideo();
    }

    function onStateChange(event) { //called when video state changes
        $('#cursorBox0').css('pointer-events', 'auto');
        $('#cursorSafeZone0').css('pointer-events', 'auto');
        $('#cursorBox1').css('pointer-events', 'auto');
        $('#cursorSafeZone1').css('pointer-events', 'auto');
        if (currentTutorialMethodNum == 1 && currentTutorialStep == 1) {
            nextStep(currentTutorialMethodNum, currentTutorialStep);
        }
        /*$('#tutorial1Checkbox1').prop('checked', true);
        $('#tutorial2Checkbox1').prop('checked', true);
        $('#tutorial3Checkbox1').prop('checked', true);
        $('#tutorial4Checkbox1').prop('checked', true);*/
    }

    function onLoadClick() {
        let videoId1 = document.getElementById("textInput").value;
        player.loadVideoById(videoId1);
    }

    function pauseVideo() {
        player.pauseVideo();
    }

    function stopVideo() {
        player.stopVideo();
    }

    //called when clicking on the play button
    function onPlayClick() {
        if (player.getPlayerState() == 5 || player.getPlayerState() == 2) {
            player.playVideo();
            $('#playButton').html('Pause');
        } else if (player.getPlayerState() == 1) {
            player.pauseVideo();
            $('#playButton').html('Play');
        }
    }

    //hides the big play button
    function hideBigPlayButton() {
        $('#bigPlayButton').css('display', 'none');
    }

    //switches to the first step of the tutorial for the given control method
    function switchTutorialStepTracker() {
        if (activeControlMethod == 'control1') {
            currentTutorialMethodNum = 1;
            currentTutorialStep = 1;
        } else if (activeControlMethod == 'control2') {
            currentTutorialMethodNum = 2;
            currentTutorialStep = 1;
        } else if (activeControlMethod == 'control3') {
            currentTutorialMethodNum = 3;
            currentTutorialStep = 1;
        } else if (activeControlMethod == 'control4') {
            currentTutorialMethodNum = 4;
            currentTutorialStep = 1;
        }
    }

    //helper function that goes to the next step in the tutorial. Hides the current step that has been finished and display the current step's complete message
    function nextStep(currentTutorialMethodNum, currentTutorialStep) {
        let stepName = 'tutorial' + currentTutorialMethodNum + 'Step' + currentTutorialStep;
        let completeMessage = 'tutorial' + currentTutorialMethodNum + 'CompleteMessage' + currentTutorialStep;
        $('#' + stepName).css('display', 'none');
        $('#' + completeMessage).css('display', 'inline');
    }

    //somehow it's not working, will need to debug later
    function checkPauseStatus() { //check if the video is paused, and update the Play/Pause button accordingly
        if (player.getPlayerState() == 5 || player.getPlayerState() == 2) {
            $('#playButton').html('Play!');
        } else if (player.getPlayerState == 1) {
            $('#playButton').html('Pause!');
        }
        console.log('This method is called');
    }

    function restartVideo() {
        player.seekTo(0);
    }

    function muteVideo() {
        player.mute();
        $('#muteButton').html('Unmute');
    }

    function toggleMute() {
        if (!player.isMuted()) {
            player.mute();
            $('#muteButton').html('Unmute');
        } else {
            player.unMute();
            $('#muteButton').html('Mute');
        }
    }

    //this switches tabs-->switches control method
    function switchTab(controlNum) { //controlNum is currently not actually a number, but a string, it's shown as 'control1' or 'control2' etc.
        let controlMethods = $('.tabContent');

        for (let i = 0; i < controlMethods.length; i++) {
            controlMethods[i].style.display = "none";
            let j = i + 1;
            $('#' + 'control' + j + 'button').css('background-color', 'transparent');
        }
        $('#' + controlNum).css('display', 'block');
        $('#' + controlNum + '_checkbox').prop('checked', true);
        $('#' + controlNum + 'button').css('background-color', '#8ff2a3');

        activeControlMethod = controlNum;
    }

    //this function will make sure only the given control method is displayed, every other control method will be hidden
    function exclusiveTab(controlNum) { //controlNum is currently not actually a number, but a string, it's shown as 'control1' or 'control2' etc.
        let controlMethods = $('.tabContent');

        for (let i = 0; i < controlMethods.length; i++) {
            controlMethods[i].style.display = "none";
            let j = i + 1;
            $('#' + 'control' + j + 'button').css('background-color', 'transparent');
            $('#' + 'control' + j + 'button').css('display', 'none');
            $('#' + 'control' + j + '_checkbox').css('display', 'none');
        }
        $('#' + controlNum).css('display', 'block');
        $('#' + controlNum + '_checkbox').prop('checked', true);
        $('#' + controlNum + 'button').css('background-color', '#8ff2a3');
        $('#' + controlNum + 'button').css('display', 'inline');

        activeControlMethod = controlNum;
    }


    //function below for camera control is currently defunct, but could potentially be used for future implementation
    let animationID; // to keep track of the animation requested if we need to stop/cancel it
    function lookUpLeft() {
        let newSettings = player.getSphericalProperties();
        newSettings['pitch'] += 2.5;
        newSettings['yaw'] += 5;
        player.setSphericalProperties(newSettings);
        animationID = requestAnimationFrame(lookUpLeft);
    }

    function lookUp() {
        let newSettings = player.getSphericalProperties();
        newSettings['pitch'] += 5;
        player.setSphericalProperties(newSettings);
        animationID = requestAnimationFrame(lookUp);
    }

    function lookUpRight() {
        let newSettings = player.getSphericalProperties();
        newSettings['pitch'] += 2.5;
        newSettings['yaw'] -= 5;
        player.setSphericalProperties(newSettings);
        animationID = requestAnimationFrame(lookUpRight);
    }

    function lookLeft() {
        let newSettings = player.getSphericalProperties();
        newSettings['yaw'] += 5;
        console.log(newSettings['yaw']);
        player.setSphericalProperties(newSettings);
        animationID = requestAnimationFrame(lookLeft);
    }

    //camera reset to default angle
    function lookReset() {
        let newSettings = player.getSphericalProperties();
        newSettings['yaw'] = 0;
        newSettings['pitch'] = 0;
        player.setSphericalProperties(newSettings);
        animationID = requestAnimationFrame(lookReset); //may not need to request animation since it just resets camera
    }

    function lookRight() {
        let newSettings = player.getSphericalProperties();
        newSettings['yaw'] -= 5;
        player.setSphericalProperties(newSettings);
        animationID = requestAnimationFrame(lookRight);
    }

    function lookDownLeft() {
        let newSettings = player.getSphericalProperties();
        newSettings['pitch'] -= 2.5;
        newSettings['yaw'] += 5;
        player.setSphericalProperties(newSettings);
        animationID = requestAnimationFrame(lookDownLeft);
    }

    function lookDown() {
        let newSettings = player.getSphericalProperties();
        newSettings['pitch'] -= 5;
        player.setSphericalProperties(newSettings);
        animationID = requestAnimationFrame(lookDown);
    }

    function lookDownRight() {
        let newSettings = player.getSphericalProperties();
        newSettings['pitch'] -= 2.5;
        newSettings['yaw'] -= 5;
        player.setSphericalProperties(newSettings);
        animationID = requestAnimationFrame(lookDownRight);
    }

    function stopCamera() {
        cancelAnimationFrame(animationID);
    }

</script>

</body>
</html>
