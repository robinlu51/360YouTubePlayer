<!--
TODO change the auto mute on the video player
-->
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="StyleControl.css">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>
</head>
<body>
<!-- Button trigger modal, unused for now -->
<!--
<button type="button" class="btn btn-primary" data-toggle="modal" data-target="#videoSeenModal">
    Launch demo modal
</button>
-->

<!-- Modal -->

<!--
if there's a mismatch in number of videos seen, send back to first window to reselect.
-->
<div class="modal fade" id="videoSeenCountModal" tabindex="-1" role="dialog" aria-labelledby="videoSeenCountModalLabel" aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="videoSeenCountModalLabel">Video Library</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <p>Please select the number of videos you have watched so far</p>
                <form name="videoSeenCountForm">
                    <input type="radio" id="videoSeenCount0" name="videoCount" value="0">
                    <label for="videoSeenCount0">0</label><br>
                    <input type="radio" id="videoSeenCount1" name="videoCount" value="1">
                    <label for="videoSeenCount1">1</label><br>
                    <input type="radio" id="videoSeenCount2" name="videoCount" value="2">
                    <label for="videoSeenCount2">2</label><br>
                    <input type="radio" id="videoSeenCount3" name="videoCount" value="3">
                    <label for="videoSeenCount3">3</label><br>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                <!-- change the video-->
                <button type="button" id = "savechange" class="btn btn-primary">Save changes</button>
            </div>
        </div>
    </div>
</div>


<div class="modal fade" id="videoSeenModal" tabindex="-1" role="dialog" aria-labelledby="videoSeenModalLabel" aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="videoSeenModalLabel">Video Library</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                Please select the videos you have already seen <br>
                <br>
                <!-- TODO adjust thumbnail to appropriate size-->
                <input type="checkbox" id="video1ModalCheckbox">
                <label for="video1ModalCheckbox" id="video1ModalLabel">Lockdown City</label><br>
                <img id="video1Thumbnail" style="max-width: 450px; max-height: 300px; padding: 10px 10px 10px 10px" src="./LockdownCity.jpg"
                     onclick="modalVideoSelectToggle('1')">
                <br>

                <input type="checkbox" id="video2ModalCheckbox">
                <label for="video2ModalCheckbox" id="video2ModalLabel">Baby Pandas</label><br>
                <img id="video2Thumbnail" style="max-width: 450px; max-height: 300px; padding: 10px 10px 10px 10px" src="./BabyPandas.jpg"
                     onclick="modalVideoSelectToggle('2')">
                <br>

                <input type="checkbox" id="video3ModalCheckbox">
                <label for="video3ModalCheckbox" id="video3ModalLabel">Cruise Tour</label><br>
                <img id="video3Thumbnail" style="max-width: 450px; max-height: 300px; padding: 10px 10px 10px 10px" src="./CruiseTour.jpg"
                     onclick="modalVideoSelectToggle('3')">
                <br>

                <input type="checkbox" id="video4ModalCheckbox">
                <label for="video4ModalCheckbox" id="video4ModalLabel">Lions 360</label><br>
                <img id="video4Thumbnail" style="max-width: 450px; max-height: 300px; padding: 10px 10px 10px 10px" src="./lions360.jpg"
                     onclick="modalVideoSelectToggle('4')">
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                <!-- change the video-->
                <button type="button" class="btn btn-primary" onclick="videoRandomization();
                $('#videoSeenModal').modal('hide');">Save changes</button>
            </div>
        </div>
    </div>
</div>

<form id="videoControl0">
    <!--
    sPyAQQklc1s
    NLB4Fcxh1iU
    biz9q2L-OvE
    <input type="text" id="textInput" value="G-XZhKqQAHU">
    -->
    <button type="button" class="popup"
            onclick="window.open('https://robinlu51.github.io/360YouTubePlayer/TutorialPage.html');">Tutorial
    </button>

    <button type="button" id="playButton" class="button" onclick="onPlayClick()">Play</button>
    <!--
    <button type="button" class="button" onclick="pauseVideo()">Pause!</button>
    -->
    <button type="button" id="restartButton" class="button" onclick="restartVideo()">Restart!</button>
    <button type="button" id="muteButton" class="button" onclick="muteVideo()">Mute</button>
    <input type="checkbox" id="visualIndicatorCheckBox" onclick="toggleVisualIndicator()">
    <label for="visualIndicatorCheckBox" id="visualIndicatorLabel">Show Visual Indicator</label>
    <!--
    <button type="button" class="button" onclick="onLoadClick()">Load!</button>
    <button type="button" class="button" onclick="stopVideo()">Stop!</button>
    -->
    <div id="controlOptions0">
        <div class="tab" id="controlMethodTab">
            <input type="checkbox" id="control1_checkbox">
            <button type="button" id="control1button" class="tablinks" onclick="switchTab('control1')"
                    style="background-color: #8ff2a3">Perspective Control with Mouse
            </button>
            <input type="checkbox" id="control2_checkbox">
            <button type="button" id="control2button" class="tablinks" onclick="switchTab('control2')">Adaptive
                Perspective Control with Mouse
            </button>
            <input type="checkbox" id="control3_checkbox">
            <button type="button" id="control3button" class="tablinks" onclick="switchTab('control3')">Direction
                Buttons
            </button>
            <input type="checkbox" id="control4_checkbox">
            <button type="button" id="control4button" class="tablinks" onclick="switchTab('control4')">Drag and Drop
            </button>
            <input type="checkbox" id="control5_checkbox">
            <button type="button" id="control5button" class="tablinks" onclick="switchTab('control5')">Click and Move
            </button>
            <input type="checkbox" id="control6_checkbox">
            <button type="button" id="control6button" class="tablinks" onclick="switchTab('control6')">Perspective Control Alt
            </button>
        </div>

        <div id="player0"></div>


        <div id="control1" class="tabContent">
            <input type="checkbox" id="x_axis" onclick="invertX()">
            <label for="x_axis" style="margin-right: 50px" id="x_axis_label">Invert X-axis control</label>
            <input type="checkbox" id="y_axis" onclick="invertY()">
            <label for="y_axis" id="y_axis_label">Invert Y-axis control</label>
            <p id="massValue">This should be default mass value, you shouldn't see this!</p>
            <!--
            Although conceptually, mass isn't a percentage, we are presenting it to this way,
            to make it easier to understand for the user
            -->
            <div id="sliderBar" class="sliderContainer">
                <input class='slider' type='range' min='0' max='99' value='95' id='massSliderValue'
                       onchange="updateMass(this.value)">
            </div>

            <!--
            Tutorial insertion
            -->
            <div id="tutorialSection1" style="margin-top: 10px;margin-bottom: 10px;text-align: center">
            </div>

            <div id="cursorBox0" class="cursorBox">
                <div id="cursorSafeZone0" class="safeZone"></div>
            </div>
        </div>

        <div id="control2" class="tabContent">
            <div id="tutorialSection2" style="margin-top: 10px;margin-bottom: 10px;text-align: center">
            </div>

            <!--
            <p id="mouseCoords1" style="clear: none;">Mouse cursor X/Y: 0, 0</p>
            -->
            <div id="cursorBox1" class="cursorBox">
                <div id="cursorSafeZone1" class="safeZone"></div>
            </div>
        </div>

        <div id="control3" class="tabContent">
            <div id="tutorialSection3" style="margin-top: 10px;margin-bottom: 10px;text-align: center">
            </div>

            <div id="directionBlockBox0" class="blockBox"></div>
            <div id="directionBlockBox1" class="blockBox"></div>
            <div id="directionBlockBox2" class="blockBox"></div>
            <div id="directionHighlightBox" class="highlightBox">
            </div>
        </div>
        <div id="control4" class="tabContent">
            <div id="tutorialSection4" style="margin-top: 10px;margin-bottom: 10px;text-align: center">
            </div>

            <div id="cursorBox4" class="cursorBox">
                <div id="dragAndDropBox0" class="blockBox"></div>
                <!--<div id="dragAndDropBox1" class="blockBox"></div>-->
            </div>
            <!--<div id="timelineBox0" class="blockBox"></div> currently not needed sincewe don't block timeline control-->
        </div>
        <div id="control5" class="tabContent">
            <div id="tutorialSection5" style="margin-top: 10px;margin-bottom: 10px;text-align: center">
            </div>

            <div id="clickAndMoveBox0" class="cursorBox"></div>
        </div>
        <div id="control6" class="tabContent">
            <div id="tutorialSection6" style="margin-top: 10px;margin-bottom: 10px;text-align: center">
            </div>

            <div id="cursorBox6" class="cursorBox">
            </div>
        </div>

        <!-- TODO make big play button smaller and more transparent-->
        <button type="button" id="bigPlayButton" class="bigButton"
                onclick="hideBigPlayButton();switchTutorialStepTracker();onPlayClick()"><i class="fa fa-play"></i></button>

    </div>
</form>

<div class="container-fluid">
    <div class="row">
        <!--bootstrap has been taken out, add col-md-8, 4 if need to be restored
        -->
    </div>
</div>
<script>
    // This code loads the IFrame Player API code asynchronously.
    let tag = document.createElement('script');

    tag.src = "https://www.youtube.com/iframe_api";
    let firstScriptTag = document.getElementsByTagName('script')[0];
    firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);

    let videoCount = 4; //total number of videos available from videoRandomization() process
    let videoSeenCount = 0;
    //adds event listener for the radio buttons that's used to keep track of how many videos the user has seen
    let radios = document.forms["videoSeenCountForm"].elements["videoCount"];
    for(let i = 0, max = radios.length; i < max; i++) {
        radios[i].onclick = function() {
            videoSeenCount = this.value;
        }
    }

    let PROPERTIES = ['yaw', 'pitch', 'roll', 'fov'];
    let player;
    let showVisualIndicator = false;
    let videoControlPadding = 5; //5px of padding for the entire interface
    $('#videoControl0').css('padding', videoControlPadding + 'px');
    let controlOptionsPadding = 5;
    $('#controlOptions0').css('padding', controlOptionsPadding + 'px');
    $(document).ready(function () {
        //   $('#control1').css('display', 'none');
        //this is done so that on load, only control 1 is displayed
        $('#control2').css('display', 'none');
        $('#control3').css('display', 'none');
        $('#control4').css('display', 'none');
        $('#control5').css('display', 'none');
        //TODO check how this is working without hiding control 6

        document.getElementById("savechange").addEventListener("click", function(){
            $('#videoSeenCountModal').modal('hide');
            $('#videoSeenModal').modal('show');
            $('#videoSeenModal').css("overflow", "auto");
        })

        //auto show the modal window on load to check which video the user has seen
        $('#videoSeenCountModal').modal('show');
        //$('#videoSeenModal').modal('show');
    });

    let netYawChange = 0; //keeps track of how much the horizontal FOV has changed
    let netPitchChange = 0; //keeps track of how much the vertical FOV has changed
    let firstYawAlert1 = false; //keeps track of whether the first yaw change alert has been sent out
    //It's name firstYawAlert1, because the 1 indicates it's used for tutorial 1
    let firstPitchAlert1 = false; //keeps track of whether the first pitch change alert has been sent out
    let firstYawAlert2 = false; //keeps track of whether the first yaw change alert has been sent out
    //It's name firstYawAlert2, because the 2 indicates it's used for tutorial 2
    let firstPitchAlert2 = false; //keeps track of whether the first pitch change alert has been sent out
    let netYawChangeThreshold = 1500;
    let netPitchChangeThreshold = 750;

    let activeControlMethod = 'control1';// this keeps tracks of the current active control method number, currently only used for the tutorial

    document.getElementById("control1_checkbox").disabled = true;
    document.getElementById("control2_checkbox").disabled = true;
    document.getElementById("control3_checkbox").disabled = true;
    document.getElementById("control4_checkbox").disabled = true;
    document.getElementById("control5_checkbox").disabled = true;

    let currentTutorialMethodNum = 0; //keeps track of which control method is active in the tutorial, 1 indicates control method 1, 2 indicates control method 2, etc.
    let currentTutorialStep = 0; //keeps track of which tutorial step the user is currently on, for now, 1 indicates step 1, 2 indicates step 2, etc.

    let tutorialMessage1 = [ // component used to assemble the messages that will be shown to the user for control method 1 tutorial
        {
            type: 0, //type 0 for instruction message, type 1 for message that will be displayed on completion
            //if we add more types, remember to update logic in renderHTML()
            sectionID: 1, //indicate which tutorial this is for, with Perspective Control w/ Mouse being 1, Drag & Drop being 4, etc.
            stepNum: 1, // step number that this message belongs to, start at 1 corresponding to the step number. Completion messages have the same step number as the step it belongs to
            message: "To start, first click on the big start button in the middle", // Leave a space at the beginning of instructions because of the existence of checkboxes
            verifyFunc: function () { // verifyFunc is used to set up event listeners and other functions that will be used to check tutorial progress within each step
                //let eventLF = function () { //this currently doesn't do anything since nothing calls verifyFunc() for this element yet
                console.log('Alert 0'); //TODO this alert is currently only for debugging purposes, remove when finished implementing
                //}
                //document.getElementById("bigPlayButton").addEventListener('click', eventLF);
            }
        },
        {
            type: 1,
            sectionID: 1,
            stepNum: 1,
            message: "Well done! Click this button to go to the next step.",
            verifyFunc: function () {
                console.log('Alert 1');
            }
        },
        {
            type: 0,
            sectionID: 1,
            stepNum: 2,
            message: "Once the video starts, the camera will automatically accelerate towards the direction of your mouse cursor <p id=\"tutorial1li2\" style=\"display:inline-block;margin-left: 10px\">(Horizontal: <span id='horizontalCameraTrack1'>0</span>/" + netYawChangeThreshold + ", Vertical: <span id='verticalCameraTrack1'>0</span>/" + netPitchChangeThreshold + ")</p>",
            verifyFunc: function () {
                //let previousYaw = player.getSphericalProperties()['yaw'];
                //let previousPitch = player.getSphericalProperties()['pitch'];

                let prevMouseX = mouseX;
                let prevMouseY = mouseY;
                let eventLF = function (event) {
                    //let newYaw = player.getSphericalProperties()['yaw'];
                    //let newPitch = player.getSphericalProperties()['pitch'];
                    // //This calculation is currently bugged, since Yaw only goes from [0, 360), Pitch only goes from [-90, 90], there's a problem with overflow
                    //netYawChange += Math.abs(previousYaw - newYaw);
                    //netPitchChange += Math.abs(previousPitch - newPitch);
                    let tempMouseX = event.clientX;
                    let tempMouseY = event.clientY;
                    netYawChange += Math.abs(tempMouseX - prevMouseX);
                    netPitchChange += Math.abs(tempMouseY - prevMouseY);
                    prevMouseX = tempMouseX;
                    prevMouseY = tempMouseY;
                    //previousYaw = newYaw;
                    //previousPitch = newPitch;
                    if (netYawChange < netYawChangeThreshold) {
                        document.querySelector('#horizontalCameraTrack1').innerHTML = `${Math.round(netYawChange)}`;
                    } else {
                        document.querySelector('#horizontalCameraTrack1').innerHTML = `${netYawChangeThreshold}`;
                    }
                    if (netPitchChange < netPitchChangeThreshold) {
                        document.querySelector('#verticalCameraTrack1').innerHTML = `${Math.round(netPitchChange)}`;
                    } else {
                        document.querySelector('#verticalCameraTrack1').innerHTML = `${netPitchChangeThreshold}`;
                    }
                    /*
                    if (netYawChange < netYawChangeThreshold && netPitchChange < netPitchChangeThreshold) {
                        document.querySelector('#tutorial1li2').innerHTML = `(Horizontal: ${netYawChange}/2500, Vertical: ${netPitchChange}/150)`;
                    } else if (netYawChange >= netYawChangeThreshold && netPitchChange < netPitchChangeThreshold) {
                        document.querySelector('#tutorial1li2').innerHTML = `(Horizontal: 2500/2500, Vertical: ${netPitchChange}/150)`;
                    } else if (netYawChange < netYawChangeThreshold && netPitchChange >= netPitchChangeThreshold) {
                        document.querySelector('#tutorial1li2').innerHTML = `(Horizontal: ${netYawChange}/2500, Vertical: 150/150)`;
                    } else {
                        document.querySelector('#tutorial1li2').innerHTML = `(Horizontal: 2500/2500, Vertical: 150/150)`;
                    }*/

                    if ((firstYawAlert1 && firstPitchAlert1) && ((currentTutorialMethodNum == 1) && (currentTutorialStep == 2))) {
                        //$('#tutorial1Checkbox2').prop('checked', true);
                        nextStep(currentTutorialMethodNum, currentTutorialStep);
                        //$('#tutorial1Step3').css('display', 'inline');
                    }

                    if (netYawChange > netYawChangeThreshold && firstYawAlert1 == false) {
                        firstYawAlert1 = true;
                        console.log('Yaw moved 1500');
                    }
                    if (netPitchChange > netPitchChangeThreshold && firstPitchAlert1 == false) {
                        firstPitchAlert1 = true;
                        console.log('Pitch moved 750');
                    }
                    //TODO remember to remove event listener
                }
                document.getElementById("cursorBox0").addEventListener('mousemove', eventLF);
            }
        },
        {
            type: 1,
            sectionID: 1,
            stepNum: 2,
            message: "Well done! Click this button to go to the next step.",
            verifyFunc: function () {
                console.log('Alert 3');
            }
        },
        {
            type: 0,
            sectionID: 1,
            stepNum: 3,
            message: "To stop camera movement, simply move your mouse cursor back to the center of the video player<p id=\"tutorial1li3\" style=\"display:inline-block;margin-left: 10px\">Stop counter: 0/3</p>",
            verifyFunc: function () {
                //
                let control1StopCounter = 0;
                let eventLF = function () {
                    mouseInsideSafeZone0 = true;
                    if (control1StopCounter < 3 && ((currentTutorialMethodNum == 1) && (currentTutorialStep == 3))) { //only start tracking step 3 after step 2 has been completed
                        control1StopCounter++;
                    }
                    document.querySelector('#tutorial1li3').innerHTML = `Stop counter: ${control1StopCounter}/3`;
                    if ((control1StopCounter >= 3) && ((currentTutorialMethodNum == 1) && (currentTutorialStep == 3))) {
                        //$('#tutorial1Checkbox3').prop('checked', true);
                        nextStep(currentTutorialMethodNum, currentTutorialStep);
                        //$('#tutorial1Step4').css('display', 'inline');
                        // get rid of event handler because it is not necessary anymore
                        document.getElementById("cursorSafeZone0").removeEventListener('mouseenter', eventLF);
                    }
                }
                document.getElementById("cursorSafeZone0").addEventListener('mouseenter', eventLF);
            }
        },
        {
            type: 1,
            sectionID: 1,
            stepNum: 3,
            message: "Well done! Click this button to go to the next step.",
            verifyFunc: function () {
                console.log('Alert 5');
            }
        },
        {
            type: 0,
            sectionID: 1,
            stepNum: 4,
            message: "You can also click on the center of the video player to disable camera movement",
            verifyFunc: function () {
                console.log('Alert 6');
                let eventLF = function () {
                    nextStep(currentTutorialMethodNum, currentTutorialStep);
                    //TODO remember to remove event listener
                }
                document.getElementById("cursorSafeZone0").addEventListener('click', eventLF)
            }
        },
        {
            type: 1,
            sectionID: 1,
            stepNum: 4,
            message: "Well done! Click this button to go to the next step.",
            verifyFunc: function () {
                console.log('Alert 7');
            }
        },
        {
            type: 0,
            sectionID: 1,
            stepNum: 5,
            message: "Click on the center of the video player again to enable it again",
            verifyFunc: function () {
                let eventLF = function () {
                    nextStep(currentTutorialMethodNum, currentTutorialStep);
                    //TODO remember to remove event listener
                }
                document.getElementById("cursorSafeZone0").addEventListener('click', eventLF);
            }
        },
        {
            type: 1,
            sectionID: 1,
            stepNum: 5,
            message: "Well done! Click this button to go to the next step.",
            verifyFunc: function () {
                console.log('Alert 9');
            }
        },
        {
            type: 0,
            sectionID: 1,
            stepNum: 6,
            message: "Congratulations! You've completed this tutorial. Here is the code: 1234",
            verifyFunc: function () {
                console.log('Alert 10');
            }
        }
    ];

    let tutorialMessage2 = [ // component used to assemble the messages that will be shown to the user for control method 2 tutorial
        {
            type: 0, //type 0 for instruction message, type 1 for message that will be displayed on completion
            //if we add more types, remember to update logic in renderHTML()
            sectionID: 2, //indicate which tutorial this is for, with Perspective Control w/ Mouse being 1, Drag & Drop being 4, etc.
            stepNum: 1, // step number that this message belongs to, start at 1 corresponding to the step number. Completion messages have the same step number as the step it belongs to
            message: "To start, first click on the big start button in the middle", // Leave a space at the beginning of instructions because of the existence of checkboxes
            verifyFunc: function () { // verifyFunc is used to set up event listeners and other functions that will be used to check tutorial progress within each step
                //let eventLF = function () { //this currently doesn't do anything since nothing calls verifyFunc() for this element yet
                console.log('Alert 0'); // this alert is currently only for debugging purposes, remove when finished implementing
                //}
                //document.getElementById("bigPlayButton").addEventListener('click', eventLF);
            }
        },
        {
            type: 1,
            sectionID: 2,
            stepNum: 1,
            message: "Well done! Click this button to go to the next step.",
            verifyFunc: function () {
                console.log('Alert 1');
            }
        },
        {
            type: 0,
            sectionID: 2,
            stepNum: 2,
            message: "Once the video starts, the camera will automatically accelerate towards the direction of your mouse cursor <p id=\"tutorial2li2\" style=\"display:inline-block;margin-left: 10px\">(Horizontal: <span id='horizontalCameraTrack2'>0</span>/" + netYawChangeThreshold + ", Vertical: <span id='verticalCameraTrack2'>0</span>/" + netPitchChangeThreshold + ")</p>",
            verifyFunc: function () {
                //let previousYaw = player.getSphericalProperties()['yaw'];
                //let previousPitch = player.getSphericalProperties()['pitch'];

                let prevMouseX = mouseX;
                let prevMouseY = mouseY;
                let eventLF = function (event) {
                    //let newYaw = player.getSphericalProperties()['yaw'];
                    //let newPitch = player.getSphericalProperties()['pitch'];
                    // //This calculation is currently bugged, since Yaw only goes from [0, 360), Pitch only goes from [-90, 90], there's a problem with overflow
                    //netYawChange += Math.abs(previousYaw - newYaw);
                    //netPitchChange += Math.abs(previousPitch - newPitch);
                    let tempMouseX = event.clientX;
                    let tempMouseY = event.clientY;
                    netYawChange += Math.abs(tempMouseX - prevMouseX); /*I think it should be fine to name it this which is identical to tutorial 1's this step.
                    since they're in different data structures, and there's currently no way to get to another tutorial once you're on this step*/
                    netPitchChange += Math.abs(tempMouseY - prevMouseY);
                    prevMouseX = tempMouseX;
                    prevMouseY = tempMouseY;
                    //previousYaw = newYaw;
                    //previousPitch = newPitch;
                    if (netYawChange < netYawChangeThreshold) {
                        document.querySelector('#horizontalCameraTrack2').innerHTML = `${Math.round(netYawChange)}`;
                    } else {
                        document.querySelector('#horizontalCameraTrack2').innerHTML = `${netYawChangeThreshold}`;
                    }
                    if (netPitchChange < netPitchChangeThreshold) {
                        document.querySelector('#verticalCameraTrack2').innerHTML = `${Math.round(netPitchChange)}`;
                    } else {
                        document.querySelector('#verticalCameraTrack2').innerHTML = `${netPitchChangeThreshold}`;
                    }

                    if ((firstYawAlert2 && firstPitchAlert2) && ((currentTutorialMethodNum == 2) && (currentTutorialStep == 2))) {
                        //$('#tutorial1Checkbox2').prop('checked', true);
                        nextStep(currentTutorialMethodNum, currentTutorialStep);
                        //$('#tutorial1Step3').css('display', 'inline');
                    }

                    if (netYawChange > netYawChangeThreshold && firstYawAlert2 == false) {
                        firstYawAlert2 = true;
                        console.log('Yaw moved 1500');
                    }
                    if (netPitchChange > netPitchChangeThreshold && firstPitchAlert2 == false) {
                        firstPitchAlert2 = true;
                        console.log('Pitch moved 750');
                    }
                    //TODO remember to remove event listener
                }
                document.getElementById("cursorBox1").addEventListener('mousemove', eventLF);
            }
        },
        {
            type: 1,
            sectionID: 2,
            stepNum: 2,
            message: "Well done! Click this button to go to the next step.",
            verifyFunc: function () {
                console.log('Alert 3');
            }
        },
        {
            type: 0,
            sectionID: 2,
            stepNum: 3,
            message: "To stop camera movement, simply move your mouse cursor back to the center of the video player<p id=\"tutorial2li3\" style=\"display:inline-block;margin-left: 10px\">Stop counter: 0/3</p>",
            verifyFunc: function () {
                //
                let control2StopCounter = 0;
                let eventLF = function () {
                    mouseInsideSafeZone0 = true;
                    if (control2StopCounter < 3 && ((currentTutorialMethodNum == 2) && (currentTutorialStep == 3))) { //only start tracking step 3 after step 2 has been completed
                        control2StopCounter++;
                    }
                    document.querySelector('#tutorial2li3').innerHTML = `Stop counter: ${control2StopCounter}/3`;
                    if ((control2StopCounter >= 3) && ((currentTutorialMethodNum == 2) && (currentTutorialStep == 3))) {
                        //$('#tutorial1Checkbox3').prop('checked', true);
                        nextStep(currentTutorialMethodNum, currentTutorialStep);
                        //$('#tutorial1Step4').css('display', 'inline');
                        // get rid of event handler because it is not necessary anymore
                        document.getElementById("cursorSafeZone1").removeEventListener('mouseenter', eventLF);
                    }
                }
                document.getElementById("cursorSafeZone1").addEventListener('mouseenter', eventLF);
            }
        },
        {
            type: 1,
            sectionID: 2,
            stepNum: 3,
            message: "Well done! Click this button to go to the next step.",
            verifyFunc: function () {
                console.log('Alert 5');
            }
        },
        {
            type: 0,
            sectionID: 2,
            stepNum: 4,
            message: "You can also click on the center of the video player to disable camera movement",
            verifyFunc: function () {
                console.log('Alert 6');
                let eventLF = function () {
                    nextStep(currentTutorialMethodNum, currentTutorialStep);
                    //TODO remember to remove event listener
                }
                document.getElementById("cursorSafeZone1").addEventListener('click', eventLF)
            }
        },
        {
            type: 1,
            sectionID: 2,
            stepNum: 4,
            message: "Well done! Click this button to go to the next step.",
            verifyFunc: function () {
                console.log('Alert 7');
            }
        },
        {
            type: 0,
            sectionID: 2,
            stepNum: 5,
            message: "Click on the center of the video player again to enable it again",
            verifyFunc: function () {
                let eventLF = function () {
                    nextStep(currentTutorialMethodNum, currentTutorialStep);
                    //TODO remember to remove event listener
                }
                document.getElementById("cursorSafeZone1").addEventListener('click', eventLF);
            }
        },
        {
            type: 1,
            sectionID: 2,
            stepNum: 5,
            message: "Well done! Click this button to go to the next step.",
            verifyFunc: function () {
                console.log('Alert 9');
            }
        },
        {
            type: 0,
            sectionID: 2,
            stepNum: 6,
            message: "Click anywhere else inside the video player, and you can move the safe zone area to where you clicked",
            verifyFunc: function () {
                let eventLF = function () {
                    nextStep(currentTutorialMethodNum, currentTutorialStep);
                    //TODO remember to remove event listener
                }
                document.getElementById("cursorBox1").addEventListener('click', eventLF);
            }
        },
        {
            type: 1,
            sectionID: 2,
            stepNum: 6,
            message: "Well done! Click this button to go to the next step.",
            verifyFunc: function () {
                console.log('Alert 11');
            }
        },
        {
            type: 0,
            sectionID: 2,
            stepNum: 7,
            message: "Click that area you just clicked again to lock camera movement.",
            verifyFunc: function () {
                let eventLF = function () {
                    nextStep(currentTutorialMethodNum, currentTutorialStep);
                    //TODO remember to remove event listener
                }
                document.getElementById("cursorSafeZone1").addEventListener('click', eventLF);
            }
        },
        {
            type: 1,
            sectionID: 2,
            stepNum: 7,
            message: "Well done! Click this button to go to the next step.",
            verifyFunc: function () {
                console.log('Alert 13');
            }
        },
        {
            type: 0,
            sectionID: 2,
            stepNum: 8,
            message: "Click a different area on the screen to move your safe zone to that new spot at any time",
            verifyFunc: function () {
                let eventLF = function () {
                    nextStep(currentTutorialMethodNum, currentTutorialStep);
                    //TODO remember to remove event listener
                }
                document.getElementById("cursorBox1").addEventListener('click', eventLF);
            }
        },
        {
            type: 1,
            sectionID: 2,
            stepNum: 8,
            message: "Well done! Click this button to go to the next step.",
            verifyFunc: function () {
                console.log('Alert 15');
            }
        },
        {
            type: 0,
            sectionID: 2,
            stepNum: 9,
            message: "Congratulations! You've completed this tutorial. Here is the code: 1234",
            verifyFunc: function () {
                console.log('Alert 16');
            }
        }
    ];

    let tutorialMessage3 = [ // component used to assemble the messages that will be shown to the user for control method 3 tutorial
        {
            type: 0, //type 0 for instruction message, type 1 for message that will be displayed on completion
            //if we add more types, remember to update logic in renderHTML()
            sectionID: 3, //indicate which tutorial this is for, with Perspective Control w/ Mouse being 1, Drag & Drop being 4, etc.
            stepNum: 1, // step number that this message belongs to, start at 1 corresponding to the step number. Completion messages have the same step number as the step it belongs to
            message: "To start, first click on the big start button in the middle", // Leave a space at the beginning of instructions because of the existence of checkboxes
            verifyFunc: function () { // verifyFunc is used to set up event listeners and other functions that will be used to check tutorial progress within each step
                //let eventLF = function () { //this currently doesn't do anything since nothing calls verifyFunc() for this element yet
                console.log('Alert 0'); // this alert is currently only for debugging purposes, remove when finished implementing
                //}
                //document.getElementById("bigPlayButton").addEventListener('click', eventLF);
            }
        },
        {
            type: 1,
            sectionID: 3,
            stepNum: 1,
            message: "Well done! Click this button to go to the next step.",
            verifyFunc: function () {
                console.log('Alert 1');
            }
        },
        {
            type: 0,
            sectionID: 3,
            stepNum: 2,
            message: "To move the camera around, click the highlighted button wheel, camera will move in the direction you click on",
            verifyFunc: function () {
                if (true) {//TODO this currently just advances to the next step, since I don't know what to check for, without a eventListener I can add
                    nextStep(currentTutorialMethodNum, currentTutorialStep);
                }
                console.log('Alert 2');
            }
        },
        {
            type: 1,
            sectionID: 3,
            stepNum: 2,
            message: "Well done! Click this button to go to the next step.",
            verifyFunc: function () {
                console.log('Alert 3');
            }
        },
        {
            type: 0,
            sectionID: 3,
            stepNum: 3,
            message: "Congratulations! You've completed this tutorial. Here is the code: 1234",
            verifyFunc: function () {
                console.log('Alert 4');
            }
        }

    ];

    let tutorialMessage4 = [ // component used to assemble the messages that will be shown to the user for control method 4 tutorial
        {
            type: 0, //type 0 for instruction message, type 1 for message that will be displayed on completion
            //if we add more types, remember to update logic in renderHTML()
            sectionID: 4, //indicate which tutorial this is for, with Perspective Control w/ Mouse being 1, Drag & Drop being 4, etc.
            stepNum: 1, // step number that this message belongs to, start at 1 corresponding to the step number. Completion messages have the same step number as the step it belongs to
            message: "To start, first click on the big start button in the middle", // Leave a space at the beginning of instructions because of the existence of checkboxes
            verifyFunc: function () { // verifyFunc is used to set up event listeners and other functions that will be used to check tutorial progress within each step
                //let eventLF = function () { //this currently doesn't do anything since nothing calls verifyFunc() for this element yet
                console.log('Alert 0'); // this alert is currently only for debugging purposes, remove when finished implementing
                //}
                //document.getElementById("bigPlayButton").addEventListener('click', eventLF);
            }
        },
        {
            type: 1,
            sectionID: 4,
            stepNum: 1,
            message: "Well done! Click this button to go to the next step.",
            verifyFunc: function () {
                console.log('Alert 1');
            }
        },
        {
            type: 0,
            sectionID: 4,
            stepNum: 2,
            message: "To move the camera around, click the highlighted button wheel, camera will move in the direction you click on",
            verifyFunc: function () {
                if (true) {//TODO this currently just advances to the next step, since I don't know what to check for, without a eventListener I can add
                    nextStep(currentTutorialMethodNum, currentTutorialStep);
                }
                console.log('Alert 2');
            }
        },
        {
            type: 1,
            sectionID: 4,
            stepNum: 2,
            message: "Well done! Click this button to go to the next step.",
            verifyFunc: function () {
                console.log('Alert 3');
            }
        },
        {
            type: 0,
            sectionID: 4,
            stepNum: 3,
            message: "Congratulations! You've completed this tutorial. Here is the code: 1234",
            verifyFunc: function () {
                console.log('Alert 4');
            }
        }

    ];

    let tutorialMessage5 = [ // component used to assemble the messages that will be shown to the user for control method 4 tutorial
        {
            type: 0, //type 0 for instruction message, type 1 for message that will be displayed on completion
            //if we add more types, remember to update logic in renderHTML()
            sectionID: 5, //indicate which tutorial this is for, with Perspective Control w/ Mouse being 1, Drag & Drop being 4, etc.
            stepNum: 1, // step number that this message belongs to, start at 1 corresponding to the step number. Completion messages have the same step number as the step it belongs to
            message: "To start, first click on the big start button in the middle", // Leave a space at the beginning of instructions because of the existence of checkboxes
            verifyFunc: function () { // verifyFunc is used to set up event listeners and other functions that will be used to check tutorial progress within each step
                //let eventLF = function () { //this currently doesn't do anything since nothing calls verifyFunc() for this element yet
                console.log('Alert 0'); // this alert is currently only for debugging purposes, remove when finished implementing
                //}
                //document.getElementById("bigPlayButton").addEventListener('click', eventLF);
            }
        },
        {
            type: 1,
            sectionID: 5,
            stepNum: 1,
            message: "Well done! Click this button to go to the next step.",
            verifyFunc: function () {
                console.log('Alert 1');
            }
        },
        {
            type: 0,
            sectionID: 5,
            stepNum: 2,
            message: "To move the camera around, click the highlighted button wheel, camera will move in the direction you click on",
            verifyFunc: function () {
                if (true) {//TODO this currently just advances to the next step, since I don't know what to check for, without a eventListener I can add
                    nextStep(currentTutorialMethodNum, currentTutorialStep);
                }
                console.log('Alert 2');
            }
        },
        {
            type: 1,
            sectionID: 5,
            stepNum: 2,
            message: "Well done! Click this button to go to the next step.",
            verifyFunc: function () {
                console.log('Alert 3');
            }
        },
        {
            type: 0,
            sectionID: 5,
            stepNum: 3,
            message: "Congratulations! You've completed this tutorial. Here is the code: 1234",
            verifyFunc: function () {
                console.log('Alert 4');
            }
        }
    ];

    let tutorialMessage6 = [ // component used to assemble the messages that will be shown to the user for control method 4 tutorial
        {
            type: 0, //type 0 for instruction message, type 1 for message that will be displayed on completion
            //if we add more types, remember to update logic in renderHTML()
            sectionID: 6, //indicate which tutorial this is for, with Perspective Control w/ Mouse being 1, Drag & Drop being 4, etc.
            stepNum: 1, // step number that this message belongs to, start at 1 corresponding to the step number. Completion messages have the same step number as the step it belongs to
            message: "To start, first click on the big start button in the middle", // Leave a space at the beginning of instructions because of the existence of checkboxes
            verifyFunc: function () { // verifyFunc is used to set up event listeners and other functions that will be used to check tutorial progress within each step
                //let eventLF = function () { //this currently doesn't do anything since nothing calls verifyFunc() for this element yet
                console.log('Alert 0'); // this alert is currently only for debugging purposes, remove when finished implementing
                //}
                //document.getElementById("bigPlayButton").addEventListener('click', eventLF);
            }
        },
        {
            type: 1,
            sectionID: 6,
            stepNum: 1,
            message: "Well done! Click this button to go to the next step.",
            verifyFunc: function () {
                console.log('Alert 1');
            }
        },
        {
            type: 0,
            sectionID: 6,
            stepNum: 2,
            message: "To move the camera around, click the highlighted button wheel, camera will move in the direction you click on",
            verifyFunc: function () {
                if (true) {//TODO this currently just advances to the next step, since I don't know what to check for, without a eventListener I can add
                    nextStep(currentTutorialMethodNum, currentTutorialStep);
                }
                console.log('Alert 2');
            }
        },
        {
            type: 1,
            sectionID: 6,
            stepNum: 2,
            message: "Well done! Click this button to go to the next step.",
            verifyFunc: function () {
                console.log('Alert 3');
            }
        },
        {
            type: 0,
            sectionID: 6,
            stepNum: 3,
            message: "Congratulations! You've completed this tutorial. Here is the code: 1234",
            verifyFunc: function () {
                console.log('Alert 4');
            }
        }

    ];

    let renderHTML = function (message) { //this renders the html elements, assembling them together
        let renderedHTML;
        if (message.type == 0) { // if it's an instruction message, render it this way
            if (message.stepNum == 1) { // if it's the first tutorial message of its section, display it to start
                renderedHTML = '<div id="tutorial' + message.sectionID + 'Step' + message.stepNum + '" class="tutorialStep">' + message.message + '</div>';
            } else { // if it isn't the first tutorial message of its section, set display to none to start
                renderedHTML = '<div id="tutorial' + message.sectionID + 'Step' + message.stepNum + '" class="tutorialStep" style="display: none">' + message.message + '</div>';
            }
        } else { // if it's a completion message, render it this way
            //for now, we can use else, considering we only have type 0 and type 1, if we add more types in the future, will need to update this
            renderedHTML = '<div id="tutorial' + message.sectionID + 'CompleteMessage' + message.stepNum + '" class="tutorialStep" style="display: none">' + message.message + '<br><button type="button" onclick="$(\'#tutorial' + message.sectionID + 'Step' + (message.stepNum + 1) + '\').css(\'display\', \'inline\');$(\'#tutorial' + message.sectionID + 'CompleteMessage' + message.stepNum + '\').css(\'display\',\'none\');currentTutorialStep=' + (message.stepNum + 1) + ';tutorialMessage' + message.sectionID + '[' + (message.stepNum * 2) + '].verifyFunc()' + '">Next</button></div>'
            //here, we set currentTutorialStep to current step number + 1 because we're moving onto the next step
        }
        return renderedHTML;
    }

    let renderMessage = function () { //called when page is ready, renders all messages in current control method section, although only the first is shown at the start
        for (let i = 0; i < tutorialMessage1.length; i++) {
            $('#tutorialSection1').append(renderHTML(tutorialMessage1[i]));
        }
        for (let i = 0; i < tutorialMessage2.length; i++) {
            $('#tutorialSection2').append(renderHTML(tutorialMessage2[i]));
        }
        for (let i = 0; i < tutorialMessage3.length; i++) {
            $('#tutorialSection3').append(renderHTML(tutorialMessage3[i]));
        }
        for (let i = 0; i < tutorialMessage4.length; i++) {
            $('#tutorialSection4').append(renderHTML(tutorialMessage4[i]));
        }
        for (let i = 0; i < tutorialMessage5.length; i++) {
            $('#tutorialSection5').append(renderHTML(tutorialMessage5[i]));
        }
        for (let i = 0; i < tutorialMessage6.length; i++) {
            $('#tutorialSection6').append(renderHTML(tutorialMessage6[i]));
        }
    }

    $(document).ready(function () {
        //console.log(tutorialMessage[0][0].message);
        //console.log(currentTutorialMethodNum);
        renderMessage();
    })


    let myURL = new URL(window.location.href); //collection for all URL parameters

    //There is currently one more URL parameter located in onYouTubeIframeAPIReady(), vidID, which is the video ID

    /* currently unused because we're not blocking timeline control access
    should also be renamed disableTimelineControl, because it's meant to disable timeline control
    let hideControl = myURL.searchParams.get("hideControl"); //URL parameter for whether timeline control is hidden
    let defaultHideControl = '0';
    if (!hideControl > '') { // if there's no control number, default to control 1
        hideControl = defaultHideControl;
    }*/

    let controlMethod = myURL.searchParams.get("controlMethod"); //URL parameter for the control method on load
    let defaultControlMethod = '0';
    if (!controlMethod > '') { // if there's no input for this, default to 0, which shows all control methods
        controlMethod = defaultControlMethod;
    }

    let hideControlOption = myURL.searchParams.get("hideControlOption"); //URL parameter for whether the control options are hidden
    let defaultHideControlOption = '0';
    if (!hideControlOption > '') { // if there's no input for this, default to 0, which shows all control options
        hideControlOption = defaultHideControlOption;
    }

    //TODO this is currently unused, need to implement feature
    let showTutorial = myURL.searchParams.get("showTutorial"); //URL parameter for whether the tutorial is shown
    let defaultShowTutorial = '0';
    if (!showTutorial > '') { // if there's no input for this, default to 0, which shows tutorial
        showTutorial = defaultShowTutorial;
    }

    let videoType = myURL.searchParams.get("videoType"); //URL parameter for whether the randomization pulls from
    // dynamic or static video pool
    let defaultVideoType = '0'; //default is 0, which is for static videos, value should be set to 1 for dynamic
    if(!videoType > '') { // if there's no input for this, default to 0, which show static videos
        videoType = defaultVideoType;
    }

    if (videoType == 1){ //if video type is 1, switch to dynamic videos
        $('#video1ModalLabel').html('Roller Coaster');
        $('#video1Thumbnail').attr("src", 'rollercoaster.jpg');
        $('#video2ModalLabel').html('Dreams of Dali');
        $('#video2Thumbnail').attr("src", "dreamsofdali.jpg");
        $('#video3ModalLabel').html('Mountain Biking');
        $('#video3Thumbnail').attr("src", "mountainbiking.jpg");
        $('#video4ModalLabel').html('Making Carbonara');
        $('#video4Thumbnail').attr("src", "carbonara.jpg");
    }

    let movableSafeZoneCenterX = 0; //with respect to the cursor box, at 0, 0 if at top left
    let movableSafeZoneCenterY = 0; // THIS WORKS BECAUSE OF CURRENT IMPLEMENTATION, since you have to click on safe zone first to start moving
    // therefore you will always call moveSafeZone, which updates the center of the safe zone for movement detection purpose
    // if implementation changes, this will cause camera to behave like the center is at top left corner, until you move safe zone once

    let cursorBox0Active = true; //indicates if the cursor box is active
    $('#cursorSafeZone0').click(function () {
        if (showVisualIndicator) {
            if (cursorBox0Active) {
                $('#cursorSafeZone0').css('background-color', 'yellow');
            } else {
                $('#cursorSafeZone0').css('background-color', 'greenyellow');
            }
        }
        cursorBox0Active = !cursorBox0Active;
    });

    let cursorBox1Active = true; //indicates if the cursor box is active
    $('#cursorSafeZone1').click(function () {
        if (showVisualIndicator) {
            if (cursorBox1Active) {
                $('#cursorSafeZone1').css('background-color', 'yellow');
            } else {
                $('#cursorSafeZone1').css('background-color', 'greenyellow');
            }
        }
        cursorBox1Active = !cursorBox1Active;
    });

    let massValueText = document.querySelector('#massValue');
    //mass is the user assigned variable that controls the momentum of camera movement, on a scale of 0-1
    let mass = document.getElementById('massSliderValue').value; // exists to update the mass value and text for the first time only
    //let mass = 95; //for user study version, we might want to give mass a defined value instead of being adjustable.
    massValueText.innerText = `The current mass value is at: ${mass}%`; //subsequent updates are handled by updateMass()
    mass /= 100; // needed so we don't need to call getElementById twice, and keep the mass value on 0-1 scale

    let prevXVelocity = 0; //by default, the velocity starts at 0
    let prevYVelocity = 0;

    //adding event listeners for Cursor Box
    let mouseInsideBox0 = false;
    let mouseInsideSafeZone0 = false;
    document.getElementById("cursorBox0").addEventListener('mouseenter', function () {
        mouseInsideBox0 = true;
    });
    document.getElementById("cursorBox0").addEventListener('mouseleave', function () {
        mouseInsideBox0 = false;
    });
    document.getElementById("cursorSafeZone0").addEventListener('mouseenter', function () {
        mouseInsideSafeZone0 = true;
    });
    document.getElementById("cursorSafeZone0").addEventListener('mouseleave', function () {
        mouseInsideSafeZone0 = false;
    });

    //adding event listeners for Cursor Box Alt (control 2)
    let mouseInsideBox1 = false;
    let mouseInsideSafeZone1 = false;
    document.getElementById("cursorBox1").addEventListener('mouseenter', function () {
        mouseInsideBox1 = true;
    });
    document.getElementById("cursorBox1").addEventListener('mouseleave', function () {
        mouseInsideBox1 = false;
    });
    document.getElementById("cursorSafeZone1").addEventListener('mouseenter', function () {
        mouseInsideSafeZone1 = true;
    });
    document.getElementById("cursorSafeZone1").addEventListener('mouseleave', function () {
        mouseInsideSafeZone1 = false;
    });

    //adding event listeners for Drag & Drop Alt
    //TODO look into this one, is this a remnant of the failed alternative drag and drop?
    let mouseInsideBox4 = false;
    document.getElementById("cursorBox4").addEventListener('mouseenter', function () {
        mouseInsideBox4 = true;
    });
    document.getElementById("cursorBox4").addEventListener('mouseleave', function () {
        mouseInsideBox4 = false;
    });


    //adding event listeners for Click and Move (control 5)
    document.getElementById("clickAndMoveBox0").addEventListener('click', clickCameraMove);

    //adding event listeners for Perspective Control Alt (control 6)
    let mouseInsideBox6 = false;
    let mouseHeldDown6 = false;
    document.getElementById("cursorBox6").addEventListener('mouseenter', function () {
        mouseInsideBox6 = true;
    });
    document.getElementById("cursorBox6").addEventListener('mouseleave', function () {
        mouseInsideBox6 = false;
    });
    document.getElementById("cursorBox6").addEventListener('mousedown', function () {
        mouseHeldDown6 = true;
    });
    document.getElementById("cursorBox6").addEventListener('mouseup', function () {
        mouseHeldDown6 = false;
    });

    let mouseX = 0; // the mouse X coordinate WITH RESPECT TO THE VISIBLE SCREEN
    let mouseY = 0; // the code should show it with respect to

    //control for Perspective Control 1
    document.getElementById("cursorBox0").addEventListener('mouseenter', updateCoords);
    document.getElementById("cursorBox0").addEventListener('mousemove', updateCoords);
    document.getElementById("cursorBox0").addEventListener('mouseenter', cursorCameraControl0);

    //control for Perspective Control 2
    document.getElementById("cursorBox1").addEventListener('mouseenter', updateCoords);
    document.getElementById("cursorBox1").addEventListener('mousemove', updateCoords);
    document.getElementById("cursorBox1").addEventListener('mouseenter', cursorCameraControl1);
    document.getElementById("cursorBox1").addEventListener('click', moveSafeZone);

    //this line below should add an event listener, to update the playing status, in case that the user pause/unpauses in
    //Drag&Drop method and the Play/Pause button isn't updated
    //document.getElementById('cursorBox1').addEventListener('click', checkPauseStatus);

    //control for control method 4
    let cameraControl4Active = false;
    document.getElementById('cursorBox4').addEventListener('mouseenter', updateCoords);
    document.getElementById('cursorBox4').addEventListener('mousemove', updateCoords);
    document.getElementById('cursorBox4').addEventListener('mousemove', cursorCameraControl4)
    document.getElementById('cursorBox4').addEventListener('mousedown', function () {
        $(this).css('pointer-events', 'none');
        cameraControl4Active = true;
    });
    document.getElementById('cursorBox4').addEventListener('mouseup', function () {
        $(this).css('pointer-events', 'auto');
        cameraControl4Active = false;
    });

    //control for Perspective Control Alt
    document.getElementById("cursorBox6").addEventListener('mouseenter', updateCoords);
    document.getElementById("cursorBox6").addEventListener('mousemove', updateCoords);
    document.getElementById("cursorBox6").addEventListener('mouseenter', cursorCameraControl6);

    //let mouseCoordsText0 = document.querySelector('#mouseCoords0');
    //let mouseCoordsText1 = document.querySelector('#mouseCoords1');

    function updateMass(value) { //update the mass value AND text displayed
        mass = value / 100;
        massValueText.innerText = `The current mass value is at: ${value}%`;
    }

    function updateCoords(event) { //update the mouse's coordinates in the global variable
        mouseX = event.clientX;
        mouseY = event.clientY;
    }

    function moveSafeZone(event) { // moves the safe zone based on mouse click location, center on click location
        $('#cursorSafeZone1').css('margin-left', mouseX - playerLeftGapPublicHolder - safeZone0Radius + 'px');
        $('#cursorSafeZone1').css('margin-top', mouseY - control1HeightPublicHolder - safeZone0Radius + 'px');
        movableSafeZoneCenterX = mouseX - playerLeftGapPublicHolder;
        movableSafeZoneCenterY = mouseY - control1HeightPublicHolder;
    }

    let xModifier = 1; // 1 is the default value, -1 if axis is inverted
    let yModifier = 1;

    function invertX() { //used to invert x-axis control
        xModifier = -xModifier;
    }

    function invertY() { //used to invert y-axis control
        yModifier = -yModifier;
    }

    function cursorCameraControl0() { //camera control for Cursor Box control method
        //get the mouse cursor's current coordinates, with top left of cursor box to be 0,0
        let x = Math.round(mouseX - playerLeftGapPublicHolder);
        let y = Math.round(mouseY - control1HeightPublicHolder);
        //mouseCoordsText0.innerText = `Mouse cursor X/Y: ${x}, ${y}, center at ${windowWidthPublicHolder / 2}, ${windowHeightPublicHolder / 2}`;

        let cameraMultiplierX = 0.003; //necessary to control the overall camera speed
        let cameraMultiplierY = 0.002;
        let newSettings = player.getSphericalProperties();
        let targetedXVelocity = 0; //the velocity we want to achieve
        let targetedYVelocity = 0;
        if (!mouseInsideSafeZone0 && cursorBox0Active) {
            targetedXVelocity = windowWidthPublicHolder / 2 - x; // find the center for cursor box, windowWidth/2 is the num of pixels from edge to center
            targetedYVelocity = windowHeightPublicHolder / 2 - y;
        }
        let combinedXVelocity = ((1 - mass) * targetedXVelocity + mass * prevXVelocity); // the actual velocity calculated with momentum
        let combinedYVelocity = ((1 - mass) * targetedYVelocity + mass * prevYVelocity);
        newSettings['yaw'] += xModifier * cameraMultiplierX * combinedXVelocity;
        newSettings['pitch'] += yModifier * cameraMultiplierY * combinedYVelocity;
        player.setSphericalProperties(newSettings);
        prevXVelocity = combinedXVelocity; //update the previous velocity with the newly calculated value
        prevYVelocity = combinedYVelocity;
        if (mouseInsideBox0) {
            setTimeout(cursorCameraControl0, 16); //timeout at 16ms to ensure around 60 updates/second, since there are roughly 60 * 16 ms in a second
        }
    }

    function cursorCameraControl1() { //camera control for Cursor Box Alt control method
        //get the mouse cursor's current coordinates, with top left of cursor box to be 0,0
        let x = Math.round(mouseX - playerLeftGapPublicHolder);
        let y = Math.round(mouseY - control1HeightPublicHolder);
        // mouseCoordsText1.innerText = `Mouse cursor X/Y: ${x - mouseX}, ${y - mouseY}, center at ${windowWidthPublicHolder / 2}, ${windowHeightPublicHolder / 2}`;

        let cameraMultiplierX = 0.003; //necessary to control the overall camera speed
        let cameraMultiplierY = 0.002;
        let newSettings = player.getSphericalProperties();
        let targetedXVelocity = 0; //the velocity we want to achieve
        let targetedYVelocity = 0;
        if (!mouseInsideSafeZone1 && cursorBox1Active) {
            targetedXVelocity = movableSafeZoneCenterX - x; // find the center for cursor box, windowWidth/2 is the num of pixels from edge to center
            targetedYVelocity = movableSafeZoneCenterY - y;
        }
        let combinedXVelocity = ((1 - mass) * targetedXVelocity + mass * prevXVelocity); // the actual velocity calculated with momentum
        let combinedYVelocity = ((1 - mass) * targetedYVelocity + mass * prevYVelocity);
        newSettings['yaw'] += xModifier * cameraMultiplierX * combinedXVelocity;
        newSettings['pitch'] += yModifier * cameraMultiplierY * combinedYVelocity;
        player.setSphericalProperties(newSettings);
        prevXVelocity = combinedXVelocity; //update the previous velocity with the newly calculated value
        prevYVelocity = combinedYVelocity;
        if (mouseInsideBox1) {
            setTimeout(cursorCameraControl1, 16); //timeout at 16ms to ensure around 60 updates/second, since there are roughly 60 * 16 ms in a second
        }
    }

    function cursorCameraControl4() { //camera control for alternative Drag & Drop method
        //get the mouse cursor's current coordinates, with top left of cursor box to be 0,0
        if (cameraControl4Active) {
            return;
        }
        let x = Math.round(mouseX - playerLeftGapPublicHolder);
        let y = Math.round(mouseY - control1HeightPublicHolder);
        let newSettings = player.getSphericalProperties();
        newSettings['yaw'] += 100;
        newSettings['pitch'] += 100;
        player.setSphericalProperties(newSettings);
        if (mouseInsideBox4) {
            setTimeout(cursorCameraControl4, 16); //timeout at 16ms to ensure around 60 updates/second, since there are roughly 60 * 16 ms in a second
        }
    }
    function getTanFromDegrees(degrees) { //imported from mozilla.org, returns the tangent of a number given the degree
        return Math.tan(degrees * Math.PI / 180);
    }

    function radians_to_degrees(radians) { // converts radians to degrees
        let pi = Math.PI;
        return radians * (180 / pi);
    }

    let goalFramerate = 60; //the targeted fps we are looking for. Unit in frames per second
    let cameraMoveDuration = 0.4; //how long it takes to complete one camera movement. Unit in second

    //Probably should've started this in the main page but I guess having this on the tutorial page first lets me try
    //to get a look on how it'll look when I make tutorials for this, so that's still not entirely bad
    function clickCameraMove(event) { //function for moving camera in control 5 (click and move)
        let animationID; // to keep track of the animation requested if we need to stop/cancel it

        mouseX = event.clientX;
        mouseY = event.clientY;
        //get the mouse cursor's current coordinates, with top left of cursor box to be 0,0
        let x = Math.round(mouseX - playerLeftGapPublicHolder);
        let y = Math.round(mouseY - control1HeightPublicHolder);
        let newSettings = player.getSphericalProperties();
        let xOffset = x - windowWidthPublicHolder / 2; /* The difference between x and the center of the current player,
        with 0 being directly on the center,  positive being to the right of center, negative being to the left*/
        let yOffset = y - windowHeightPublicHolder / 2; //same as xOffset, but positive being below, negative being above
        //newSettings['yaw'] -= xOffset/windowWidthPublicHolder*50*2;
        let totalYawChange = radians_to_degrees(Math.atan(xOffset / (windowWidthPublicHolder / 2) * getTanFromDegrees(50)));
        //newSettings['yaw'] -= radians_to_degrees(Math.atan(xOffset / (windowWidthPublicHolder / 2) * getTanFromDegrees(50)));
        //newSettings['yaw'] -= radians_to_degrees(Math.atan(Math.sqrt(Math.pow(xOffset, 2) + Math.pow(yOffset, 2)) / (windowWidthPublicHolder / 2) * getTanFromDegrees(50)));
        let totalPitchChange = radians_to_degrees(Math.atan(yOffset / (windowHeightPublicHolder / 2) * getTanFromDegrees(34))); //this value needs to be tempered with a bit more

        for(let i = 0;i < goalFramerate * cameraMoveDuration;i++){
            setTimeout(function(){
                newSettings['yaw'] -= totalYawChange/(goalFramerate*cameraMoveDuration);
                newSettings['pitch'] -= totalPitchChange/(goalFramerate*cameraMoveDuration);
                player.setSphericalProperties(newSettings);
            }, (1000/goalFramerate)*i); //timeout at 16ms to ensure around 60 updates/second, since there are roughly 60 * 16 ms in a second
        }
        //newSettings['pitch'] -= radians_to_degrees(Math.atan(yOffset / (windowHeightPublicHolder / 2) * getTanFromDegrees(34))); //this value needs to be tempered with a bit more
        //player.setSphericalProperties(newSettings);
    }

    function cursorCameraControl6() { //camera control for Perspective Control Alt (control 6)
        //get the mouse cursor's current coordinates, with top left of cursor box to be 0,0
        let x = Math.round(mouseX - playerLeftGapPublicHolder);
        let y = Math.round(mouseY - control1HeightPublicHolder);

        let cameraMultiplierX = 0.003; //necessary to control the overall camera speed
        let cameraMultiplierY = 0.002;
        let newSettings = player.getSphericalProperties();
        let targetedXVelocity = 0; //the velocity we want to achieve
        let targetedYVelocity = 0;
        if (mouseHeldDown6) {
            targetedXVelocity = windowWidthPublicHolder / 2 - x; // find the center for cursor box, windowWidth/2 is the num of pixels from edge to center
            targetedYVelocity = windowHeightPublicHolder / 2 - y;
        }
        let combinedXVelocity = ((1 - mass) * targetedXVelocity + mass * prevXVelocity); // the actual velocity calculated with momentum
        let combinedYVelocity = ((1 - mass) * targetedYVelocity + mass * prevYVelocity);
        newSettings['yaw'] += xModifier * cameraMultiplierX * combinedXVelocity;
        newSettings['pitch'] += yModifier * cameraMultiplierY * combinedYVelocity;
        player.setSphericalProperties(newSettings);
        prevXVelocity = combinedXVelocity; //update the previous velocity with the newly calculated value
        prevYVelocity = combinedYVelocity;
        if (mouseInsideBox6) {
            setTimeout(cursorCameraControl6, 16); //timeout at 16ms to ensure around 60 updates/second, since there are roughly 60 * 16 ms in a second
        }
    }

    let timelineBarHeight = 50;//the height is 50 px
    let control1HeightPublicHolder;
    let playerLeftGapPublicHolder;
    let windowWidthPublicHolder;
    let windowHeightPublicHolder;
    let safeZone0Radius = $('#cursorSafeZone0').height() / 2; //the Cursor Box control method's safe zone area's radius

    function onYouTubeIframeAPIReady() { //<=== does as it says
        let videoRatioWidth = 16; //video player ratio is 16:9 for now
        let videoRatioHeight = 9;
        let videoId0 = myURL.searchParams.get("vidID");
        //let defaultVideoID = 'G-XZhKqQAHU'; //for now, default to the Alien 'HELP' video
        //let defaultVideoID = 'ilyQMA0tq-U';//the default video is "Under the net"
        if (!videoId0 > '') { // if there's no URL parameter, default to designated video
            //videoId0 = defaultVideoID;
            videoId0 = null;
        }

        //let adjustedWidth = window.innerWidth * 2 / 3 - 20; //ratio for the col-8 and 4 bootstrap grid
        let control1Height = $('#playButton').height() + $('#controlMethodTab').height() + $('#x_axis_label').height() + $('#massValue').height() + $('#sliderBar').height() + 35; //+ $('#mouseCoords').height()
        let windowHeight = window.innerHeight - 20 - control1Height; //these numbers indicate the maximum size the video player can be,
        //it is actually the video player's height, no the window
        let windowWidth = window.innerWidth; //maximum width on screen that can be used for display
        //we want to make the video player as large as allowed without needing to scroll, while maintaining a 16:9 ratio
        if (windowHeight >= videoRatioHeight / videoRatioWidth * windowWidth) {
            windowHeight = videoRatioHeight / videoRatioWidth * windowWidth;
        } else if (windowWidth >= videoRatioWidth / videoRatioHeight * windowHeight) {
            windowWidth = videoRatioWidth / videoRatioHeight * windowHeight;
        }
        let playerLeftGap = (window.innerWidth - windowWidth) / 2; //the distance of the gap between player and left/right end, so we can center video player
        let player0 = $('#player0');
        player0.css('position', 'absolute');
        player0.css('top', control1Height + 'px');
        player0.css('left', playerLeftGap + 'px');

        hideBigPlayButton();
        let bigPlayButtonHeight = 250;
        let bigPlayButtonWidth = 250;
        $('#bigPlayButton').css('font-size', bigPlayButtonHeight / 2 + 'px');
        $('#bigPlayButton').css('height', bigPlayButtonHeight + 'px');
        $('#bigPlayButton').css('width', bigPlayButtonWidth + 'px');
        $('#bigPlayButton').css('top', control1Height + (windowHeight - bigPlayButtonHeight) / 2 + 'px');
        $('#bigPlayButton').css('left', playerLeftGap + (windowWidth - bigPlayButtonWidth) / 2 + 'px');

        control1HeightPublicHolder = control1Height;
        playerLeftGapPublicHolder = playerLeftGap;
        let cursorBox0 = $('#cursorBox0');
        cursorBox0.css('pointer-events', 'none');
        cursorBox0.css('top', control1Height + 'px');
        cursorBox0.css('width', windowWidth + 'px');
        cursorBox0.css('height', windowHeight - timelineBarHeight + 'px');
        cursorBox0.css('margin-left', playerLeftGap + 'px');
        windowWidthPublicHolder = windowWidth;
        windowHeightPublicHolder = windowHeight;
        $('#cursorSafeZone0').css('margin-top', windowHeight / 2 - safeZone0Radius + 'px');
        $('#cursorSafeZone0').css('margin-left', windowWidth / 2 - safeZone0Radius + 'px');
        $('#cursorSafeZone0').css('pointer-events', 'none');


        movableSafeZoneCenterX = windowWidth / 2;
        movableSafeZoneCenterY = windowHeight / 2;
        let safeZone1Radius = $('#cursorSafeZone1').height() / 2; //the Cursor Box Alt control method's safe zone area's radius
        let cursorBox1 = $('#cursorBox1');
        cursorBox1.css('pointer-events', 'none');
        cursorBox1.css('top', control1Height + 'px');
        cursorBox1.css('width', windowWidth + 'px');
        cursorBox1.css('height', windowHeight - timelineBarHeight + 'px');
        cursorBox1.css('margin-left', playerLeftGap + 'px');
        $('#cursorSafeZone1').css('margin-top', windowHeight / 2 - safeZone0Radius + 'px');
        $('#cursorSafeZone1').css('margin-left', windowWidth / 2 - safeZone0Radius + 'px');
        $('#cursorSafeZone1').css('pointer-events', 'none');


        let directionButtonWidth = 65; //the size for the YouTube native navigation button, used in Direction Buttons
        let directionButtonHeight = 60;
        let directionButtonTopGap = 57;
        let directionHighlightBox0 = $('#directionHighlightBox'); //the border box that highlights the direction wheel
        directionHighlightBox0.css('left', playerLeftGap + 'px');
        directionHighlightBox0.css('top', control1Height + directionButtonTopGap + 'px');
        directionHighlightBox0.css('width', directionButtonWidth + 'px');
        directionHighlightBox0.css('height', directionButtonHeight + 'px');
        let directionBlockBox0 = $('#directionBlockBox0'); //the block box above the horizontal level of direction wheel
        directionBlockBox0.css('left', playerLeftGap + 'px');
        directionBlockBox0.css('top', control1Height + 'px');
        directionBlockBox0.css('width', windowWidth + 'px');
        directionBlockBox0.css('height', directionButtonTopGap + 'px');
        let directionBlockBox1 = $('#directionBlockBox1'); //the block box on the same horizontal level of direction wheel
        directionBlockBox1.css('left', playerLeftGap + directionButtonWidth + 'px');
        directionBlockBox1.css('top', control1Height + directionButtonTopGap + 'px');
        directionBlockBox1.css('width', windowWidth - directionButtonWidth + 'px');
        directionBlockBox1.css('height', directionButtonHeight + 'px');
        let directionBlockBox2 = $('#directionBlockBox2');
        directionBlockBox2.css('left', playerLeftGap + 'px');//the block box below the horizontal level of direction wheel
        directionBlockBox2.css('top', control1Height + directionButtonHeight + directionButtonTopGap + 'px');
        directionBlockBox2.css('width', windowWidth + 'px');
        directionBlockBox2.css('height', windowHeight - directionButtonHeight - directionButtonTopGap - timelineBarHeight + 'px');

        let cursorBox4 = $('#cursorBox4');
        //cursorBox4.css('pointer-events', 'none');
        cursorBox4.css('top', control1Height + 'px');
        cursorBox4.css('width', windowWidth + 'px');
        cursorBox4.css('height', windowHeight - timelineBarHeight + 'px');
        cursorBox4.css('margin-left', playerLeftGap + 'px');

        let dragAndDropBox0 = $('#dragAndDropBox0'); //block out the direction wheel for Drag & Drop
        dragAndDropBox0.css('left', playerLeftGap + 'px');
        dragAndDropBox0.css('top', control1Height + directionButtonTopGap + 'px');
        dragAndDropBox0.css('width', directionButtonWidth + 'px');
        dragAndDropBox0.css('height', directionButtonTopGap + 'px');
        /*
        let dragAndDropBox1 = $('#dragAndDropBox1'); //block out the timeline for Drag & Drop
        dragAndDropBox1.css('left', playerLeftGap + 'px');
        dragAndDropBox1.css('top', control1Height + windowHeight - 50 + 'px');
        dragAndDropBox1.css('width', windowWidth + 'px');
        dragAndDropBox1.css('height', 50 + 'px');
        dragAndDropBox1.css('opacity', 15 + '%');
        */

        let clickAndMoveBox0 = $('#clickAndMoveBox0');
        clickAndMoveBox0.css('pointer-events', 'auto');
        clickAndMoveBox0.css('top', control1Height + 'px');
        clickAndMoveBox0.css('width', windowWidth + 'px');
        clickAndMoveBox0.css('height', windowHeight - timelineBarHeight + 'px');
        clickAndMoveBox0.css('margin-left', playerLeftGap + 'px');

        //css for control method 6
        let cursorBox6 = $('#cursorBox6');
        cursorBox6.css('pointer-events', 'none');
        cursorBox6.css('top', control1Height + 'px');
        cursorBox6.css('width', windowWidth + 'px');
        cursorBox6.css('height', windowHeight - timelineBarHeight + 'px');
        cursorBox6.css('margin-left', playerLeftGap + 'px');

        /* currently not needed, since we're not blocking out timeline control
        it also lacks actually blocking functionality as of now, users can just click through
        let timelineBox0 = $('#timelineBox0'); //this blocks out the timeline if the hideControl URL parameter is 1
        timelineBox0.css('left', playerLeftGap + 'px');
        timelineBox0.css('top', control1Height + windowHeight - timelineBarHeight + 'px');
        timelineBox0.css('width', windowWidth + 'px');
        timelineBox0.css('height', timelineBarHeight + 1 + 'px'); //needed to add 1 px because of a stray pixel
        timelineBox0.css('display', 'none');
        timelineBox0.css('opacity', 100 + '%');
        if (hideControl == 1) {
            timelineBox0.css('display', 'block');
            timelineBox0.css('background-color', 'white');
        }*/

        //this hides almost all control options if the hideControlOption URL parameter is 1
        if (hideControlOption == 1) {
            $('#playButton').css('display', 'none');
            $('#restartButton').css('display', 'none');
            $('#muteButton').css('display', 'none');
            $('#visualIndicatorCheckBox').css('display', 'none');
            $('#visualIndicatorLabel').css('display', 'none');
            $('#x_axis').css('display', 'none');
            $('#x_axis_label').css('display', 'none');
            $('#y_axis').css('display', 'none');
            $('#y_axis_label').css('display', 'none');
            $('#massValue').css('display', 'none');
            $('#sliderBar').css('display', 'none');
        }

        //This section only executes and creates a video player if there's URL parameter specifying which video to load
        //If not, then the player should only be loaded upon the user selecting which videos they've already watched,
        //and done in videoRandomization()
        if (player == null && videoId0 != null) { // if there's no pre-existing video player, we create it here
            player = new YT.Player('player0', {
                //height: 700,
                //width: adjustedWidth,
                height: windowHeight,
                width: windowWidth,
                videoId: videoId0,
                playerVars: {
                    rel: 0, // on pause screen, only display videos from same channel, since we can't disable this following YouTube update
                    disablekb: 1 //disable keyboard control
                },
                events: {
                    'onReady': onPlayerReady,
                    'onStateChange': onStateChange
                }
            });
            $('#videoSeenCountModal').modal('hide');//auto hide modal window if a specific video ID is given,
            //since we don't need to randomize for a video any more
        }

        if (controlMethod != 0) {
            exclusiveTab('control' + controlMethod);
        }
        else{
            switchTab('control1');//if no URL parameter is given, show all controls
        }
    }

    function toggleVisualIndicator() { //toggle colored visual indicator for clickable/unclickable zones
        let visualIndicatorLabel = $('#visualIndicatorLabel');
        if (showVisualIndicator) {
            $('#cursorBox0').css('background-color', 'transparent');
            $('#cursorSafeZone0').css('background-color', 'transparent');
            $('#cursorBox1').css('background-color', 'transparent');
            $('#cursorSafeZone1').css('background-color', 'transparent');
            $('#directionBlockBox0').css('background-color', 'transparent');
            $('#directionBlockBox1').css('background-color', 'transparent');
            $('#directionBlockBox2').css('background-color', 'transparent');
            $('#dragAndDropBox0').css('background-color', 'transparent');
            $('#dragAndDropBox1').css('background-color', 'transparent');
            $('#cursorBox4').css('background-color', 'transparent');
            $('#clickAndMoveBox0').css('background-color', 'transparent');
            $('#cursorBox6').css('background-color', 'transparent');
            visualIndicatorLabel.html('Visual Indicator Shown');
        } else {
            $('#cursorBox0').css('background-color', 'lightblue');
            if (cursorBox0Active) {
                $('#cursorSafeZone0').css('background-color', 'greenyellow');
            } else {
                $('#cursorSafeZone0').css('background-color', 'yellow');
            }
            $('#cursorBox1').css('background-color', 'lightblue');
            if (cursorBox1Active) {
                $('#cursorSafeZone1').css('background-color', 'greenyellow');
            } else {
                $('#cursorSafeZone1').css('background-color', 'yellow');
            }
            $('#directionBlockBox0').css('background-color', 'lightblue');
            $('#directionBlockBox1').css('background-color', 'lightblue');
            $('#directionBlockBox2').css('background-color', 'lightblue');
            $('#dragAndDropBox0').css('background-color', 'lightblue');
            $('#dragAndDropBox1').css('background-color', 'lightblue');
            $('#cursorBox4').css('background-color', 'lightblue');
            $('#clickAndMoveBox0').css('background-color', 'lightblue');
            $('#cursorBox6').css('background-color', 'lightblue');
            visualIndicatorLabel.html('Visual Indicator Hidden');
        }
        showVisualIndicator = !showVisualIndicator;
    }

    // The API will call this function when the video player is ready.
    function onPlayerReady(event) { //currently unused
        //event.target.playVideo();
        showBigPlayButton();
    }

    function onStateChange(event) { //called when video state changes
        $('#cursorBox0').css('pointer-events', 'auto');
        $('#cursorSafeZone0').css('pointer-events', 'auto');
        $('#cursorBox1').css('pointer-events', 'auto');
        $('#cursorSafeZone1').css('pointer-events', 'auto');
        $('#cursorBox6').css('pointer-events', 'auto');
    }

    function onLoadClick() {
        let videoId1 = document.getElementById("textInput").value;
        player.loadVideoById(videoId1);
    }

    function pauseVideo() {
        player.pauseVideo();
    }

    function stopVideo() {
        player.stopVideo();
    }

    //called when clicking on the play button
    function onPlayClick() {
        if (player.getPlayerState() == 5 || player.getPlayerState() == 2) {
            player.playVideo();
            $('#playButton').html('Pause');
            if (currentTutorialStep == 1) { //this assumes that every tutorial's first step is to play the video, if that changes, remember to change this to match the else if branches below and uncomment them
                nextStep(currentTutorialMethodNum, currentTutorialStep);
            }
        } else if (player.getPlayerState() == 1) {
            player.pauseVideo();
            $('#playButton').html('Play');
        }
    }

    //show the big play button
    function showBigPlayButton() {
        $('#bigPlayButton').css('display', 'initial');
    }

    //hides the big play button
    function hideBigPlayButton() {
        $('#bigPlayButton').css('display', 'none');
    }

    //switches to the first step of the tutorial for the given control method
    function switchTutorialStepTracker() {
        if (activeControlMethod == 'control1') {
            currentTutorialMethodNum = 1;
            currentTutorialStep = 1;
        } else if (activeControlMethod == 'control2') {
            currentTutorialMethodNum = 2;
            currentTutorialStep = 1;
        } else if (activeControlMethod == 'control3') {
            currentTutorialMethodNum = 3;
            currentTutorialStep = 1;
        } else if (activeControlMethod == 'control4') {
            currentTutorialMethodNum = 4;
            currentTutorialStep = 1;
        } else if (activeControlMethod == 'control5') {
            currentTutorialMethodNum = 5;
            currentTutorialStep = 1;
        } else if (activeControlMethod == 'control6') {
            currentTutorialMethodNum = 6;
            currentTutorialStep = 1;
        }
    }

    //helper function that goes to the next step in the tutorial. Hides the current step that has been finished and display the current step's complete message
    function nextStep(currentTutorialMethodNum, currentTutorialStep) {
        let stepName = 'tutorial' + currentTutorialMethodNum + 'Step' + currentTutorialStep;
        let completeMessage = 'tutorial' + currentTutorialMethodNum + 'CompleteMessage' + currentTutorialStep;
        $('#' + stepName).css('display', 'none');
        $('#' + completeMessage).css('display', 'inline');
    }

    //somehow it's not working, will need to debug later
    function checkPauseStatus() { //check if the video is paused, and update the Play/Pause button accordingly
        if (player.getPlayerState() == 5 || player.getPlayerState() == 2) {
            $('#playButton').html('Play!');
        } else if (player.getPlayerState == 1) {
            $('#playButton').html('Pause!');
        }
        console.log('This method is called');
    }

    function restartVideo() {
        player.seekTo(0);
    }

    function muteVideo() {
        if (!player.isMuted()) {
            player.mute();
            $('#muteButton').html('Unmute');
        } else {
            player.unMute();
            $('#muteButton').html('Mute');
        }
    }

    //toggles whether the video has been selected and updates the checkbox
    function modalVideoSelectToggle(modalVideoNum){
        let videoSelected = $('#video' + modalVideoNum + 'ModalCheckbox');
        if(videoSelected.is(':checked')){
            videoSelected.prop('checked', false);
        }
        else{
            videoSelected.prop('checked', true);
        }
    }



    //provides a random video to load, based on which video has been selected
    function videoRandomization(){
        /* Here are the video ID's
        * sPyAQQklc1s Lions 360
        * ilyQMA0tq-U Under the Net
        * F1eLeIocAcU Dreams of Dali
        * BLvRnZS_OdQ 360 video player FOV calibration
        * */
        let newVideoId0;
        let videoIndex;
        let uncheckedVideoCount = 0; //counter for how many videos have been checked in the image selection page
        let videoBoxCheckedArr = []; // used to keep track of which video's box were checked, indicating
        //which one have been watched, for example, videoBoxCheckedArr[0] will hold whether video 1 was watched,
        //videoBoxCheckedArr[1] holds video 2's, etc.
        let videoLeftArr = []; //keeps track of which videos are left to be randomized
        //this exists so we can randomize with nice index that only correspond to videos that haven't been watched
        //I don't see a better way to do this at the moment

        for(let i = 0; i < videoCount; i++){
            videoBoxCheckedArr[i] = $('#video'+(i+1)+'ModalCheckbox').is(':checked');
            if(!videoBoxCheckedArr[i]){
                uncheckedVideoCount++;
                videoLeftArr[videoLeftArr.length] = i+1;//i+1 is used to indicate the video number, which will be 1 for video 1, etc.
            }
        }
        //human error checking, making sure the number of videos seen that the user provided on first modal window
        // match with the number of videos they selected on the second modal window
        if (videoSeenCount != (4-uncheckedVideoCount)){
            alert("The number of video seen does not match videos selected! Please reload page before proceeding.");
            location.reload();
            return;
        }

        if(uncheckedVideoCount == 0){ //if the user has already watched all videos, serve up a default video
            //TODO show a toast popup window https://getbootstrap.com/docs/5.0/components/toasts/
            newVideoId0 = 'sPyAQQklc1s';
        }
        else {
            // generates a random integer from 1-whatever the number of unwatched videos is
            videoIndex = Math.floor(Math.random() * uncheckedVideoCount);
            if (videoLeftArr[videoIndex] == 1){
                newVideoId0 = 'zCbQffIER_E'; //lockdown city
                if(videoType == 1){ //if video type is 1, switch to dynamic video
                    newVideoId0 = 'hNAbQYU0wpg'; //rollercoaster
                }
            }
            else if (videoLeftArr[videoIndex] == 2){
                newVideoId0 = '0XrH2WO1Mzs'; //baby pandas
                if(videoType == 1){
                    newVideoId0 = 'F1eLeIocAcU'; //dreams of dali
                }
            }
            else if (videoLeftArr[videoIndex] == 3){
                newVideoId0 = 'x4zyGhdGkmg'; //cruise tour
                if(videoType == 1){
                    newVideoId0 = '5pXzFcicSHE'; //mountain biking
                }
            }
            else{
                newVideoId0 = 'sPyAQQklc1s'; //lions 360
                if(videoType == 1){
                    newVideoId0 = 'zm3oZFu3rO4'; //making pasta
                }
            }
        }


        if (player == null) { // if there's no pre-existing video player, we create it here
            player = new YT.Player('player0', {
                //height: 700,
                //width: adjustedWidth,
                height: windowHeightPublicHolder,
                width: windowWidthPublicHolder,
                videoId: newVideoId0,
                playerVars: {
                    rel: 0, // on pause screen, only display videos from same channel, since we can't disable this following YouTube update
                    disablekb: 1 //disable keyboard control
                },
                events: {
                    'onReady': onPlayerReady,
                    'onStateChange': onStateChange
                }
            });
        }
    }

    //force loads a new video
    //Doesn't work rn, need new approach
    function loadNewVideo(){
        player = new YT.Player('player0', {
            //height: 700,
            //width: adjustedWidth,
            height: 2000,
            width: 1000,
            videoId: 'BLvRnZS_OdQ',
            playerVars: {
                rel: 0, // on pause screen, only display videos from same channel, since we can't disable this following YouTube update
                disablekb: 1 //disable keyboard control
            },
            events: {
                'onReady': onPlayerReady,
                'onStateChange': onStateChange
            }
        });
    }

    //this switches tabs-->switches control method
    function switchTab(controlNum) { //controlNum is currently not actually a number, but a string, it's shown as 'control1' or 'control2' etc.
        let controlMethods = $('.tabContent');

        for (let i = 0; i < controlMethods.length; i++) {
            controlMethods[i].style.display = "none";
            let j = i + 1;
            $('#' + 'control' + j + 'button').css('background-color', 'transparent');
        }
        $('#' + controlNum).css('display', 'block');
        $('#' + controlNum + '_checkbox').prop('checked', true);
        $('#' + controlNum + 'button').css('background-color', '#8ff2a3');

        activeControlMethod = controlNum;
    }

    //this function will make sure only the given control method is displayed, every other control method will be hidden
    function exclusiveTab(controlNum) { //controlNum is currently not actually a number, but a string, it's shown as 'control1' or 'control2' etc.
        let controlMethods = $('.tabContent');

        for (let i = 0; i < controlMethods.length; i++) {
            controlMethods[i].style.display = "none";
            let j = i + 1;
            $('#' + 'control' + j + 'button').css('background-color', 'transparent');
            $('#' + 'control' + j + 'button').css('display', 'none');
            $('#' + 'control' + j + '_checkbox').css('display', 'none');
        }
        $('#' + controlNum).css('display', 'block');
        $('#' + controlNum + '_checkbox').prop('checked', true);
        $('#' + controlNum + 'button').css('background-color', '#8ff2a3');
        $('#' + controlNum + 'button').css('display', 'inline');

        activeControlMethod = controlNum;
    }


    //function below for camera control is currently defunct, but could potentially be used for future implementation
    let animationID; // to keep track of the animation requested if we need to stop/cancel it
    function lookUpLeft() {
        let newSettings = player.getSphericalProperties();
        newSettings['pitch'] += 2.5;
        newSettings['yaw'] += 5;
        player.setSphericalProperties(newSettings);
        animationID = requestAnimationFrame(lookUpLeft);
    }

    function lookUp() {
        let newSettings = player.getSphericalProperties();
        newSettings['pitch'] += 5;
        player.setSphericalProperties(newSettings);
        animationID = requestAnimationFrame(lookUp);
    }

    function lookUpRight() {
        let newSettings = player.getSphericalProperties();
        newSettings['pitch'] += 2.5;
        newSettings['yaw'] -= 5;
        player.setSphericalProperties(newSettings);
        animationID = requestAnimationFrame(lookUpRight);
    }

    function lookLeft() {
        let newSettings = player.getSphericalProperties();
        newSettings['yaw'] += 5;
        console.log(newSettings['yaw']);
        player.setSphericalProperties(newSettings);
        animationID = requestAnimationFrame(lookLeft);
    }

    //camera reset to default angle
    function lookReset() {
        let newSettings = player.getSphericalProperties();
        newSettings['yaw'] = 0;
        newSettings['pitch'] = 0;
        player.setSphericalProperties(newSettings);
        animationID = requestAnimationFrame(lookReset); //may not need to request animation since it just resets camera
    }

    function lookRight() {
        let newSettings = player.getSphericalProperties();
        newSettings['yaw'] -= 5;
        player.setSphericalProperties(newSettings);
        animationID = requestAnimationFrame(lookRight);
    }

    function lookDownLeft() {
        let newSettings = player.getSphericalProperties();
        newSettings['pitch'] -= 2.5;
        newSettings['yaw'] += 5;
        player.setSphericalProperties(newSettings);
        animationID = requestAnimationFrame(lookDownLeft);
    }

    function lookDown() {
        let newSettings = player.getSphericalProperties();
        newSettings['pitch'] -= 5;
        player.setSphericalProperties(newSettings);
        animationID = requestAnimationFrame(lookDown);
    }

    function lookDownRight() {
        let newSettings = player.getSphericalProperties();
        newSettings['pitch'] -= 2.5;
        newSettings['yaw'] -= 5;
        player.setSphericalProperties(newSettings);
        animationID = requestAnimationFrame(lookDownRight);
    }

    function stopCamera() {
        cancelAnimationFrame(animationID);
    }

</script>

</body>
</html>
